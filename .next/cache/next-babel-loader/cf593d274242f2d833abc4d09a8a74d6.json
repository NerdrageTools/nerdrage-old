{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\n// @ts-nocheck\nimport fetch from 'isomorphic-unfetch';\nimport dynamic from 'next/dynamic';\nimport React, { Component } from 'react';\nimport JsxParser from 'react-jsx-parser';\nimport { Alert } from '~/components/Alert/Alert';\nimport { Editable } from '~/components/Editable/Editable';\nimport { Link } from '~/components/Link/Link';\nimport { Links } from '~/components/Links/Links';\nimport { TabSet } from '~/components/TabSet/TabSet';\nimport { TagBar } from '~/components/TagBar/TagBar';\nimport { Toggle } from '~/components/Toggle/Toggle';\nimport { Warning } from '~/components/Warning/Warning';\nimport { Application } from '~/contexts/Application';\nimport EditIcon from '~/icons/edit.svg';\nimport FavoriteOffIcon from '~/icons/favorite-off.svg';\nimport FavoriteOnIcon from '~/icons/favorite-on.svg';\nimport HtmlIcon from '~/icons/html.svg';\nimport NavigationIcon from '~/icons/Navigation';\nimport PublicIcon from '~/icons/public.svg';\nimport ReadIcon from '~/icons/read.svg';\nimport SecretIcon from '~/icons/secret.svg';\nimport SettingsIcon from '~/icons/settings.svg';\nimport TemplateIcon from '~/icons/template.svg';\nimport { confirm } from '~/utilities/confirm';\nimport { pluck } from '~/utilities/pluck';\nimport { URI } from '~/utilities/URI';\nvar HtmlEditor = true // // @ts-expect-error - ts does not understand next/dynamic()\n? dynamic(function () {\n  return import('../components/HtmlEditor/HtmlEditor').then(function (m) {\n    return m.HtmlEditor;\n  });\n}, {\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak('../components/HtmlEditor/HtmlEditor')];\n    },\n    modules: ['../components/HtmlEditor/HtmlEditor']\n  }\n}) : function () {\n  return /*#__PURE__*/_jsx(\"div\", {});\n};\nvar WysiwygEditor = true // // @ts-expect-error - ts does not understand next/dynamic()\n? dynamic(function () {\n  return import('../components/WysiwygEditor/WysiwygEditor').then(function (m) {\n    return m.WysiwygEditor;\n  });\n}, {\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak('../components/WysiwygEditor/WysiwygEditor')];\n    },\n    modules: ['../components/WysiwygEditor/WysiwygEditor']\n  }\n}) : function () {\n  return /*#__PURE__*/_jsx(\"div\", {});\n};\nvar STATE_FIELDS = ['_id', 'aliases', 'html', 'isOwner', 'isEditable', 'secret', 'slug', 'tags', 'template', 'title'];\n\nvar Article = /*#__PURE__*/function (_Component) {\n  _inherits(Article, _Component);\n\n  var _super = _createSuper(Article);\n\n  function Article() {\n    var _this;\n\n    _classCallCheck(this, Article);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", _objectSpread(_objectSpread({\n      activeTab: 'read',\n      editMode: false\n    }, pluck(_this.props, STATE_FIELDS)), {}, {\n      saved: _this.props._id ? pluck(_this.props, STATE_FIELDS) : {\n        title: _this.props.title || _this.context.router.query.title\n      },\n      title: _this.props.title || _this.context.router.query.title\n    }));\n\n    _defineProperty(_assertThisInitialized(_this), \"componentDidMount\", function () {\n      var slug = _this.props.slug;\n      var router = _this.context.router;\n\n      if (slug && router.query.slug !== slug) {\n        _this.setState({\n          redirectedFrom: router.query.slug\n        });\n\n        router.push(\"/article?slug=\".concat(slug), \"/article/\".concat(slug), {\n          shallow: true\n        });\n      } else {\n        _this.setState({\n          redirectedFrom: undefined\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleAliasesChange\", function (aliases) {\n      return _this.setState({\n        aliases: aliases\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleDelete\", /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var article, json;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return confirm('Are you sure you want to permanently delete this article?');\n\n            case 2:\n              if (_context.sent) {\n                _context.next = 4;\n                break;\n              }\n\n              return _context.abrupt(\"return\");\n\n            case 4:\n              _context.next = 6;\n              return fetch(\"/api/article/\".concat(_this.props.slug), {\n                method: 'DELETE'\n              });\n\n            case 6:\n              _context.next = 8;\n              return fetch(\"/api/article/\".concat(_this.props.slug));\n\n            case 8:\n              article = _context.sent;\n              _context.t0 = _objectSpread;\n              _context.t1 = _objectSpread;\n              _context.t2 = {};\n              _context.t3 = pluck;\n              _context.next = 15;\n              return article.json();\n\n            case 15:\n              _context.t4 = _context.sent;\n              _context.t5 = STATE_FIELDS;\n              _context.t6 = (0, _context.t3)(_context.t4, _context.t5);\n              _context.t7 = (0, _context.t1)(_context.t2, _context.t6);\n              _context.t8 = {};\n              _context.t9 = {\n                _id: null,\n                title: _this.context.router.query.title || ''\n              };\n              json = (0, _context.t0)(_context.t7, _context.t8, _context.t9);\n\n              _this.setState(_objectSpread(_objectSpread({}, json), {}, {\n                activeTab: 'read',\n                saved: json\n              }));\n\n              _this.context.updateUser();\n\n            case 24:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    })));\n\n    _defineProperty(_assertThisInitialized(_this), \"handleHtmlChange\", function (html) {\n      return _this.setState({\n        html: html\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleReset\", function () {\n      return _this.setState(_objectSpread({\n        activeTab: 'read'\n      }, _this.state.saved));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleSave\", /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var saved;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return fetch(\"/api/article/\".concat(_this.props.slug), {\n                body: JSON.stringify(pluck(_this.state, STATE_FIELDS)),\n                headers: {\n                  'Content-Type': 'application/json'\n                },\n                method: 'POST'\n              }).then(function (r) {\n                return r.json();\n              });\n\n            case 2:\n              saved = _context2.sent;\n\n              _this.setState(_objectSpread(_objectSpread({}, saved), {}, {\n                saved: saved\n              }));\n\n              _this.context.updateUser();\n\n            case 5:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    })));\n\n    _defineProperty(_assertThisInitialized(_this), \"handleTabClicked\", function (tab) {\n      if (tab !== _this.state.activeTab) {\n        _this.setState({\n          activeTab: tab\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleTagsChange\", function (tags) {\n      return _this.setState({\n        tags: tags\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleTitleChange\", function (title) {\n      return _this.setState({\n        title: title\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleToggleEditMode\", function () {\n      return _this.setState({\n        activeTab: _this.state.editMode ? 'read' : 'edit',\n        editMode: !_this.state.editMode\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleToggleFavorite\", /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      var updated;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return fetch(\"/api/user/my/favorites/\".concat(_this.props.slug), {\n                method: 'POST'\n              }).then(function (r) {\n                return r.json();\n              });\n\n            case 2:\n              updated = _context3.sent;\n\n              _this.context.setUser(updated);\n\n            case 4:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    })));\n\n    _defineProperty(_assertThisInitialized(_this), \"handleToggleNavigation\", /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n      var _this$props, slug, title, campaign, navigation;\n\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _this$props = _this.props, slug = _this$props.slug, title = _this$props.title;\n              campaign = _this.context.campaign;\n\n              if (campaign) {\n                _context4.next = 4;\n                break;\n              }\n\n              return _context4.abrupt(\"return\");\n\n            case 4:\n              navigation = campaign.navigation || [];\n\n              if (_this.isNavLink) {\n                navigation = navigation.filter(function (n) {\n                  return n.slug !== slug;\n                });\n              } else {\n                navigation.push({\n                  slug: slug,\n                  title: title\n                });\n              }\n\n              _this.context.updateCampaign({\n                navigation: navigation\n              });\n\n            case 7:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    })));\n\n    _defineProperty(_assertThisInitialized(_this), \"handleToggleSecret\", /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5() {\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              _this.handleUpdate({\n                secret: !_this.state.secret\n              });\n\n            case 1:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5);\n    })));\n\n    _defineProperty(_assertThisInitialized(_this), \"handleToggleTemplate\", /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6() {\n      return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              _this.handleUpdate({\n                template: !_this.state.template\n              });\n\n            case 1:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6);\n    })));\n\n    _defineProperty(_assertThisInitialized(_this), \"handleUpdate\", /*#__PURE__*/function () {\n      var _ref7 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7(payload) {\n        var keys, response, updated;\n        return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                keys = Object.keys(payload);\n                _context7.next = 3;\n                return fetch(\"/api/article/\".concat(_this.props.slug), {\n                  body: JSON.stringify(payload),\n                  headers: {\n                    'Content-Type': 'application/json'\n                  },\n                  method: 'POST'\n                });\n\n              case 3:\n                response = _context7.sent;\n                _context7.t0 = pluck;\n                _context7.t1 = void 0;\n                _context7.next = 8;\n                return response.json();\n\n              case 8:\n                _context7.t2 = _context7.sent;\n                _context7.t3 = [_context7.t2].concat(_toConsumableArray(keys));\n                updated = _context7.t0.apply.call(_context7.t0, _context7.t1, _context7.t3);\n\n                if (response.status === 200) {\n                  _this.setState(_objectSpread(_objectSpread({}, updated), {}, {\n                    saved: _objectSpread(_objectSpread({}, _this.state.saved), updated)\n                  }));\n                }\n\n              case 12:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7);\n      }));\n\n      return function (_x) {\n        return _ref7.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_this), \"renderReadOnlyContent\", function () {\n      var jsx = (_this.state.html || _this.props.html || '').trim();\n      return /*#__PURE__*/_jsxs(_Fragment, {\n        children: [/*#__PURE__*/_jsx(JsxParser, {\n          allowUnknownElements: true,\n          autoCloseVoidElements: true,\n          components: {\n            a: Link,\n            Warning: Warning\n          },\n          jsx: jsx !== null && jsx !== void 0 ? jsx : ''\n        }), /*#__PURE__*/_jsx(Links, {\n          pages: _this.props.childArticles\n        })]\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"renderSettingsTab\", function () {\n      return /*#__PURE__*/_jsxs(_Fragment, {\n        children: [/*#__PURE__*/_jsxs(\"fieldset\", {\n          children: [/*#__PURE__*/_jsx(\"legend\", {\n            children: \"Aliases\"\n          }), /*#__PURE__*/_jsx(TagBar, {\n            banned: [_this.state.slug],\n            className: \"aliases\",\n            inputSettings: {\n              placeholder: 'add alias'\n            },\n            onChange: _this.handleAliasesChange,\n            readOnly: !_this.props.isEditable,\n            tags: _this.state.aliases\n          })]\n        }), _this.props.isEditable && /*#__PURE__*/_jsxs(\"fieldset\", {\n          className: \"danger\",\n          children: [/*#__PURE__*/_jsx(\"legend\", {\n            className: \"danger\",\n            children: \"Danger\"\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: \"row\",\n            children: [/*#__PURE__*/_jsx(\"button\", {\n              className: \"danger\",\n              onClick: _this.handleDelete,\n              children: \"Delete\"\n            }), /*#__PURE__*/_jsx(\"span\", {\n              children: \"Warning: This cannot be undone.\"\n            })]\n          })]\n        })]\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"render\", function () {\n      var _this$state = _this.state,\n          _id = _this$state._id,\n          activeTab = _this$state.activeTab,\n          aliases = _this$state.aliases,\n          html = _this$state.html,\n          isEditable = _this$state.isEditable,\n          isOwner = _this$state.isOwner,\n          message = _this$state.message,\n          redirectedFrom = _this$state.redirectedFrom,\n          secret = _this$state.secret,\n          slug = _this$state.slug,\n          tags = _this$state.tags,\n          _this$state$template = _this$state.template,\n          template = _this$state$template === void 0 ? false : _this$state$template,\n          _this$state$title = _this$state.title,\n          title = _this$state$title === void 0 ? '' : _this$state$title;\n      var _this$props2 = _this.props,\n          source = _this$props2.campaign,\n          childArticles = _this$props2.childArticles,\n          httpStatusCode = _this$props2.httpStatusCode;\n      var _this$context = _this.context,\n          _this$context$campaig = _this$context.campaign,\n          campaign = _this$context$campaig === void 0 ? {} : _this$context$campaig,\n          _this$context$user$fa = _this$context.user.favorites,\n          favorites = _this$context$user$fa === void 0 ? [] : _this$context$user$fa;\n      var isFavorite = favorites.find(function (f) {\n        return f.subdomain === campaign.subdomain && f.slug === slug;\n      });\n      var readOnly = !isEditable || !_this.state.editMode;\n      var classNames = ['article page', childArticles.length ? '' : 'no-child-articles'].filter(Boolean).join(' ');\n\n      if (httpStatusCode !== 200) {\n        return /*#__PURE__*/_jsxs(\"div\", {\n          className: classNames,\n          children: [/*#__PURE__*/_jsx(Alert, {\n            children: message\n          }), _this.renderReadOnlyContent()]\n        });\n      }\n\n      return /*#__PURE__*/_jsxs(\"div\", {\n        className: classNames,\n        children: [message && /*#__PURE__*/_jsx(Alert, {\n          children: message\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: \"title-bar\",\n          children: [/*#__PURE__*/_jsx(Editable, {\n            className: \"title \".concat(title.trim() ? '' : 'default'),\n            onChange: _this.handleTitleChange,\n            placeholder: slug,\n            readOnly: readOnly,\n            value: readOnly ? _this.state.saved.title : title\n          }), redirectedFrom && /*#__PURE__*/_jsxs(\"div\", {\n            className: \"redirected-from\",\n            children: [\"Redirected From:\", /*#__PURE__*/_jsx(\"b\", {\n              children: redirectedFrom\n            })]\n          }), _id && isOwner && /*#__PURE__*/_jsx(Toggle, {\n            className: \"secret\",\n            offIcon: PublicIcon,\n            onIcon: SecretIcon,\n            onToggle: _this.handleToggleSecret,\n            value: secret\n          }), _id && campaign.isEditor && /*#__PURE__*/_jsxs(_Fragment, {\n            children: [/*#__PURE__*/_jsx(Toggle, {\n              className: \"template\",\n              offIcon: TemplateIcon,\n              onIcon: TemplateIcon,\n              onToggle: _this.handleToggleTemplate,\n              value: template\n            }), /*#__PURE__*/_jsx(Toggle, {\n              className: \"in-navigation\",\n              offIcon: NavigationIcon,\n              offProps: {\n                title: 'Not Added to Site Navigation'\n              },\n              onIcon: NavigationIcon,\n              onProps: {\n                title: 'Added to Site Navigation'\n              },\n              onToggle: _this.handleToggleNavigation,\n              value: _this.isNavLink\n            })]\n          }), campaign.isEditor && /*#__PURE__*/_jsx(Toggle, {\n            className: \"edit-mode\",\n            offIcon: EditIcon,\n            onIcon: EditIcon,\n            onToggle: _this.handleToggleEditMode,\n            value: _this.state.editMode\n          }), _id && /*#__PURE__*/_jsx(Toggle, {\n            className: \"favorite\",\n            offIcon: FavoriteOffIcon,\n            onIcon: FavoriteOnIcon,\n            onToggle: _this.handleToggleFavorite,\n            value: isFavorite\n          }), _this.isDirty && campaign.isEditor && /*#__PURE__*/_jsx(\"button\", {\n            className: \"safe\",\n            onClick: _this.handleSave,\n            children: \"Save\"\n          }), _id && _this.isDirty && campaign.isEditor && /*#__PURE__*/_jsx(\"button\", {\n            className: \"safe\",\n            onClick: _this.handleReset,\n            children: \"Reset\"\n          })]\n        }), /*#__PURE__*/_jsx(TabSet, {\n          activeTabId: activeTab,\n          buttons: /*#__PURE__*/_jsx(_Fragment, {\n            children: source.subdomain && source.subdomain !== campaign.subdomain && /*#__PURE__*/_jsxs(\"div\", {\n              className: \"source\",\n              children: [\"Source:\", ' ', /*#__PURE__*/_jsx(Link, {\n                slug: slug,\n                subdomain: source.subdomain,\n                children: source.title\n              })]\n            })\n          }),\n          onTabClicked: _this.handleTabClicked,\n          showTabs: !readOnly,\n          tabs: [{\n            contents: _this.renderReadOnlyContent(),\n            id: 'read',\n            tab: /*#__PURE__*/_jsx(ReadIcon, {})\n          }, {\n            contents: /*#__PURE__*/_jsx(WysiwygEditor, {\n              value: html,\n              onChange: _this.handleHtmlChange\n            }),\n            id: 'edit',\n            tab: /*#__PURE__*/_jsx(EditIcon, {})\n          }, {\n            contents: /*#__PURE__*/_jsx(HtmlEditor, {\n              onChange: _this.handleHtmlChange,\n              value: html\n            }),\n            id: 'html',\n            tab: /*#__PURE__*/_jsx(HtmlIcon, {})\n          }, {\n            contents: _this.renderSettingsTab(),\n            id: 'settings',\n            tab: /*#__PURE__*/_jsx(SettingsIcon, {})\n          }].filter(Boolean)\n        }), (tags.length || !readOnly) && /*#__PURE__*/_jsx(TagBar, {\n          asLinks: true,\n          banned: [slug].concat(_toConsumableArray(aliases)),\n          className: \"tags\",\n          onChange: _this.handleTagsChange,\n          readOnly: readOnly,\n          tags: tags\n        })]\n      });\n    });\n\n    return _this;\n  }\n\n  _createClass(Article, [{\n    key: \"isDirty\",\n    get: function get() {\n      var fromState = JSON.stringify(pluck(this.state, STATE_FIELDS));\n      var fromSaved = JSON.stringify(pluck(this.state.saved, STATE_FIELDS));\n      return fromState !== fromSaved;\n    }\n  }, {\n    key: \"isNavLink\",\n    get: function get() {\n      var _this2 = this;\n\n      var _this$context$campaig2 = this.context.campaign,\n          campaign = _this$context$campaig2 === void 0 ? {} : _this$context$campaig2;\n      if (!campaign.navigation || !campaign.navigation.length) return false;\n      return Boolean(campaign.navigation.find(function (n) {\n        return n.slug === _this2.props.slug;\n      }));\n    }\n  }], [{\n    key: \"getDerivedStateFromProps\",\n    value: function getDerivedStateFromProps(props, state) {\n      if (props.slug !== state.slug) {\n        var saved = pluck(props, STATE_FIELDS);\n        var title = props.title || new URLSearchParams(window.location.search).get('title') || '';\n        return _objectSpread(_objectSpread({\n          activeTab: 'read',\n          editMode: false\n        }, saved), {}, {\n          saved: _objectSpread(_objectSpread({}, saved), {}, {\n            title: title\n          }),\n          title: title\n        });\n      }\n\n      return state;\n    }\n  }]);\n\n  return Article;\n}(Component);\n\n_defineProperty(Article, \"styles\", import('./article.scss'));\n\n_defineProperty(Article, \"contextType\", Application);\n\n_defineProperty(Article, \"defaultProps\", {\n  childArticles: [],\n  html: '',\n  httpStatusCode: 200,\n  message: '',\n  title: ''\n});\n\n_defineProperty(Article, \"getInitialProps\", /*#__PURE__*/function () {\n  var _ref9 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee8(_ref8) {\n    var query, req, headers, url, response, json;\n    return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n      while (1) {\n        switch (_context8.prev = _context8.next) {\n          case 0:\n            query = _ref8.query, req = _ref8.req;\n            headers = pluck(req && req.headers, 'cookie');\n            url = \"/api/article/\".concat(query.slug);\n            if (query.template) url += \"?template=\".concat(query.template);\n            _context8.next = 6;\n            return fetch(URI(req, url), {\n              headers: headers\n            });\n\n          case 6:\n            response = _context8.sent;\n            _context8.next = 9;\n            return response.json();\n\n          case 9:\n            json = _context8.sent;\n            return _context8.abrupt(\"return\", _objectSpread({\n              httpStatusCode: response.status\n            }, json));\n\n          case 11:\n          case \"end\":\n            return _context8.stop();\n        }\n      }\n    }, _callee8);\n  }));\n\n  return function (_x2) {\n    return _ref9.apply(this, arguments);\n  };\n}());\n\nexport { Article as default };","map":null,"metadata":{},"sourceType":"module"}
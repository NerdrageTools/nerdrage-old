{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport React, { useEffect, useRef, useState } from 'react';\nimport Dialog from '~/components/Dialog/Dialog';\nimport { noop } from '~/utilities/noop';\nimport { slugify } from '~/utilities/slugs';\nimport './CreateLinkDialog.scss';\n\nvar getTemplates = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(type) {\n    var response;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return fetch(\"/api/templates/\".concat(type.toLowerCase()));\n\n          case 2:\n            response = _context.sent;\n\n            if (!(response.status === 200)) {\n              _context.next = 5;\n              break;\n            }\n\n            return _context.abrupt(\"return\", response.json());\n\n          case 5:\n            return _context.abrupt(\"return\", []);\n\n          case 6:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function getTemplates(_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nexport default function CreateLinkDialog(_ref2) {\n  var _ref2$defaultSlug = _ref2.defaultSlug,\n      defaultSlug = _ref2$defaultSlug === void 0 ? '' : _ref2$defaultSlug,\n      _ref2$defaultText = _ref2.defaultText,\n      defaultText = _ref2$defaultText === void 0 ? '' : _ref2$defaultText,\n      _ref2$onCancel = _ref2.onCancel,\n      onCancel = _ref2$onCancel === void 0 ? noop : _ref2$onCancel,\n      _ref2$onOk = _ref2.onOk,\n      _onOk = _ref2$onOk === void 0 ? noop : _ref2$onOk,\n      _ref2$slugLabel = _ref2.slugLabel,\n      slugLabel = _ref2$slugLabel === void 0 ? 'Slug' : _ref2$slugLabel,\n      _ref2$templateType = _ref2.templateType,\n      templateType = _ref2$templateType === void 0 ? null : _ref2$templateType,\n      _ref2$textLabel = _ref2.textLabel,\n      textLabel = _ref2$textLabel === void 0 ? 'Text' : _ref2$textLabel,\n      _ref2$title = _ref2.title,\n      title = _ref2$title === void 0 ? 'Create Link' : _ref2$title;\n\n  var _useState = useState(defaultText),\n      text = _useState[0],\n      setText = _useState[1];\n\n  var _useState2 = useState(defaultSlug),\n      slug = _useState2[0],\n      setSlug = _useState2[1];\n\n  var _useState3 = useState(true),\n      auto = _useState3[0],\n      setAuto = _useState3[1];\n\n  var _useState4 = useState([]),\n      templates = _useState4[0],\n      setTemplates = _useState4[1];\n\n  var _useState5 = useState(undefined),\n      templateSlug = _useState5[0],\n      setTemplate = _useState5[1];\n\n  var slugInput = useRef(null);\n  var textInput = useRef(null);\n  var templateInput = useRef(null);\n  useEffect(function () {\n    if (templateType) getTemplates(templateType).then(setTemplates);\n  }, [templateType]);\n  useEffect(function () {\n    textInput.current.focus();\n    textInput.current.select();\n  }, [true]);\n\n  var handleKeyDown = function handleKeyDown(_ref3) {\n    var key = _ref3.key;\n\n    switch (key) {\n      case 'Escape':\n        return onCancel();\n\n      case 'Enter':\n        return _onOk({\n          slug: slug,\n          templateSlug: templateSlug,\n          text: text\n        });\n\n      default:\n        return undefined;\n    }\n  };\n\n  var handleSlug = function handleSlug(_ref4) {\n    var target = _ref4.target;\n    if (auto) setAuto(false);\n    setSlug(slugify(target.value));\n  };\n\n  var handleText = function handleText(_ref5) {\n    var target = _ref5.target;\n    setText(target.value);\n    if (auto) setSlug(slugify(target.value));\n  };\n\n  var handleTemplate = function handleTemplate(_ref6) {\n    var target = _ref6.target;\n    return setTemplate(target.value);\n  };\n\n  return /*#__PURE__*/_jsxs(Dialog, {\n    className: \"create-link\",\n    modal: true,\n    onCancel: onCancel,\n    onKeyDown: handleKeyDown,\n    onOk: function onOk() {\n      return _onOk({\n        slug: slug,\n        templateSlug: templateSlug,\n        text: text\n      });\n    },\n    title: title,\n    children: [/*#__PURE__*/_jsxs(\"div\", {\n      className: \"input-wrapper\",\n      children: [/*#__PURE__*/_jsx(\"label\", {\n        children: textLabel\n      }), /*#__PURE__*/_jsx(\"input\", {\n        value: text,\n        onChange: handleText,\n        ref: textInput,\n        type: \"text\"\n      })]\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      className: \"input-wrapper\",\n      children: [/*#__PURE__*/_jsx(\"label\", {\n        children: slugLabel\n      }), /*#__PURE__*/_jsx(\"input\", {\n        value: slug,\n        onChange: handleSlug,\n        ref: slugInput,\n        type: \"text\"\n      })]\n    }), templateType && /*#__PURE__*/_jsxs(\"div\", {\n      className: \"input-wrapper\",\n      children: [/*#__PURE__*/_jsx(\"label\", {\n        children: \"Template\"\n      }), /*#__PURE__*/_jsxs(\"select\", {\n        onChange: handleTemplate,\n        ref: templateInput,\n        value: templateSlug,\n        children: [/*#__PURE__*/_jsx(\"option\", {\n          value: \"\",\n          children: \"None\"\n        }, \"none\"), templates.map(function (_ref7) {\n          var slug = _ref7.slug,\n              title = _ref7.title;\n          return /*#__PURE__*/_jsx(\"option\", {\n            value: slug,\n            children: title\n          }, slug);\n        })]\n      })]\n    })]\n  });\n}","map":null,"metadata":{},"sourceType":"module"}
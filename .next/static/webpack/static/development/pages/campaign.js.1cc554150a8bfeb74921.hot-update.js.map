{"version":3,"file":"static/webpack/static/development/pages/campaign.js.1cc554150a8bfeb74921.hot-update.js","sources":["webpack:///./pages/campaign.js"],"sourcesContent":["import React, { Component } from 'react'\nimport Editable from '@/components/Editable'\nimport PageLink from '@/components/PageLink'\nimport Toggle from '@/components/Toggle'\nimport Application from '@/contexts/Application'\nimport PublicIcon from '@/icons/public.svg'\nimport SecretIcon from '@/icons/secret.svg'\nimport ErrorPage from '@/pages/_error'\nimport pluck from '@/utilities/pluck'\nimport './campaign.scss'\n\nconst EDITOR_EDITABLE_FIELDS = ['title', 'theme']\nconst OWNER_EDITABLE_FIELDS = [...EDITOR_EDITABLE_FIELDS, 'editors', 'owners', 'players']\nconst STATE_FIELDS = [...OWNER_EDITABLE_FIELDS, 'isEditor', 'isOwner', 'isPlayer']\n\nexport default class CampaignPage extends Component {\n  static contextType = Application\n\n  state = {\n    ...pluck(this.context.campaign, STATE_FIELDS),\n  }\n\n  get isDirty() {\n    const { campaign } = this.context\n    const { isOwner, isEditor } = campaign\n    let COMPARE_FIELDS = []\n    if (isEditor) COMPARE_FIELDS = EDITOR_EDITABLE_FIELDS\n    if (isOwner) COMPARE_FIELDS = OWNER_EDITABLE_FIELDS\n\n    const fromContext = JSON.stringify(pluck(campaign, COMPARE_FIELDS))\n    const fromState = JSON.stringify(pluck(this.state, COMPARE_FIELDS))\n\n    return fromContext !== fromState\n  }\n\n  handleReset = () => this.setState(pluck(this.context.campaign, STATE_FIELDS))\n  handleSave = () => this.context.updateCampaign(this.state)\n  handleTitleChange = title => this.setState({ title })\n  handleToggleSecret = () => {\n    const { secret } = this.context.campaign\n    this.context.updateCampaign({ secret: !secret })\n  }\n  renderUserList = list => (\n    <ul className=\"user-list\">{list\n      .map(({ _id, name, username }) => (\n        <li key={_id}>\n          <PageLink type=\"user\" slug={username}>\n            {name || username}\n          </PageLink>\n        </li>\n      ))}\n    </ul>\n  )\n  render = () => {\n    const { campaign } = this.context\n    if (!campaign._id) {\n      return <ErrorPage statusCode={404} message={campaign.message} />\n    }\n\n    const { secret } = campaign\n    const { editors, isOwner, owners, players, title } = this.state\n\n    return (\n      <div className=\"campaign page\">\n        <div className=\"title-bar\">\n          <Editable\n            className=\"title\"\n            onChange={this.handleTitleChange}\n            placeholder=\"Campaign Title\"\n            readOnly={campaign.isEditable}\n            value={title}\n          />\n          {isOwner && (\n            <Toggle\n              className=\"secret\"\n              offIcon={PublicIcon}\n              onIcon={SecretIcon}\n              onToggle={this.handleToggleSecret}\n              value={secret}\n            />\n          )}\n          {this.isDirty && <>\n            <button className=\"safe\" onClick={this.handleSave}>Save</button>\n            <button className=\"safe\" onClick={this.handleReset}>Reset</button>\n          </>}\n        </div>\n        <div className=\"contents\">\n          <div className=\"left column\" />\n          <div className=\"right column\">\n            <div className=\"participants lightbox\">\n              <b>Organizers</b>\n              {this.renderUserList(owners)}\n              <b>Editors</b>\n              {this.renderUserList(editors)}\n              <b>Players</b>\n              {this.renderUserList(players)}\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AACA;AACA;;;;;;;;;;;;;;;;;;AAIA;AACA;AAeA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAFA;AAFA;AACA;AAUA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AALA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AASA;AACA;AAAA;AACA;AAAA;AAEA;AACA;AACA;AACA;AACA;AALA;AASA;AACA;AACA;AACA;AACA;AALA;AASA;AAAA;AAAA;AACA;AAAA;AAAA;AAGA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAYA;AACA;;;;;;AAhFA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;;;;AAlBA;AACA;AADA;AACA;;;;;A","sourceRoot":""}
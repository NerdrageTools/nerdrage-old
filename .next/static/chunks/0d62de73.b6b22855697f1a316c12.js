(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[11],{xPCX:function(t,e,n){"use strict";n.r(e),n.d(e,"typecheck",(function(){return Vt})),n.d(e,"escapeJsonPath",(function(){return pe})),n.d(e,"unescapeJsonPath",(function(){return fe})),n.d(e,"joinJsonPath",(function(){return le})),n.d(e,"splitJsonPath",(function(){return he})),n.d(e,"decorate",(function(){return mt})),n.d(e,"addMiddleware",(function(){return gt})),n.d(e,"process",(function(){return Lt})),n.d(e,"isStateTreeNode",(function(){return Et})),n.d(e,"flow",(function(){return ae})),n.d(e,"castFlowReturn",(function(){return se})),n.d(e,"applyAction",(function(){return ct})),n.d(e,"onAction",(function(){return ft})),n.d(e,"recordActions",(function(){return pt})),n.d(e,"createActionTrackingMiddleware",(function(){return st})),n.d(e,"setLivelinessChecking",(function(){return a})),n.d(e,"getLivelinessChecking",(function(){return s})),n.d(e,"setLivelynessChecking",(function(){return u})),n.d(e,"getType",(function(){return h})),n.d(e,"getChildType",(function(){return d})),n.d(e,"onPatch",(function(){return y})),n.d(e,"onSnapshot",(function(){return v})),n.d(e,"applyPatch",(function(){return b})),n.d(e,"recordPatches",(function(){return g})),n.d(e,"protect",(function(){return m})),n.d(e,"unprotect",(function(){return w})),n.d(e,"isProtected",(function(){return S})),n.d(e,"applySnapshot",(function(){return A})),n.d(e,"getSnapshot",(function(){return P})),n.d(e,"hasParent",(function(){return I})),n.d(e,"getParent",(function(){return O})),n.d(e,"hasParentOfType",(function(){return T})),n.d(e,"getParentOfType",(function(){return V})),n.d(e,"getRoot",(function(){return C})),n.d(e,"getPath",(function(){return j})),n.d(e,"getPathParts",(function(){return N})),n.d(e,"isRoot",(function(){return _})),n.d(e,"resolvePath",(function(){return E})),n.d(e,"resolveIdentifier",(function(){return D})),n.d(e,"getIdentifier",(function(){return R})),n.d(e,"tryResolve",(function(){return z})),n.d(e,"getRelativePath",(function(){return M})),n.d(e,"clone",(function(){return F})),n.d(e,"detach",(function(){return L})),n.d(e,"destroy",(function(){return H})),n.d(e,"isAlive",(function(){return U})),n.d(e,"addDisposer",(function(){return $})),n.d(e,"getEnv",(function(){return W})),n.d(e,"walk",(function(){return J})),n.d(e,"getMembers",(function(){return Z})),n.d(e,"getPropertyMembers",(function(){return Y})),n.d(e,"cast",(function(){return G})),n.d(e,"castToSnapshot",(function(){return B})),n.d(e,"castToReferenceSnapshot",(function(){return K})),n.d(e,"isType",(function(){return ot})),n.d(e,"isArrayType",(function(){return Ie})),n.d(e,"isFrozenType",(function(){return sn})),n.d(e,"isIdentifierType",(function(){return mn})),n.d(e,"isLateType",(function(){return rn})),n.d(e,"isLiteralType",(function(){return We})),n.d(e,"isMapType",(function(){return me})),n.d(e,"isModelType",(function(){return _e})),n.d(e,"isOptionalType",(function(){return qe})),n.d(e,"isPrimitiveType",(function(){return He})),n.d(e,"isReferenceType",(function(){return dn})),n.d(e,"isRefinementType",(function(){return Ye})),n.d(e,"isUnionType",(function(){return Be})),n.d(e,"tryReference",(function(){return x})),n.d(e,"isValidReference",(function(){return k})),n.d(e,"types",(function(){return An}));var r,i=n("cneo"),o="warn";function a(t){o=t}function s(){return o}function u(t){a(t)}!function(t){t.afterCreate="afterCreate",t.afterAttach="afterAttach",t.afterCreationFinalization="afterCreationFinalization",t.beforeDetach="beforeDetach",t.beforeDestroy="beforeDestroy"}(r||(r={}));var c=function(t,e){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function p(t,e){function n(){this.constructor=t}c(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var f=function(){return(f=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function l(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}function h(t){return Dt(t).type}function d(t,e){return Dt(t).getChildType(e)}function y(t,e){return Dt(t).onPatch(e)}function v(t,e){return Dt(t).onSnapshot(e)}function b(t,e){Dt(t).applyPatches(Gt(e))}function g(t){var e=null;function n(){e||(e=y(t,(function(t,e){r.rawPatches.push([t,e])})))}var r={rawPatches:[],get patches(){return this.rawPatches.map((function(t){return t[0]}))},get inversePatches(){return this.rawPatches.map((function(t){t[0];return t[1]}))},stop:function(){e&&e(),e=null},resume:n,replay:function(e){b(e||t,r.patches)},undo:function(e){b(e||t,r.inversePatches.slice().reverse())}};return n(),r}function m(t){var e=Dt(t);e.isRoot||Wt("`protect` can only be invoked on root nodes"),e.isProtectionEnabled=!0}function w(t){var e=Dt(t);e.isRoot||Wt("`unprotect` can only be invoked on root nodes"),e.isProtectionEnabled=!1}function S(t){return Dt(t).isProtected}function A(t,e){return Dt(t).applySnapshot(e)}function P(t,e){void 0===e&&(e=!0);var n=Dt(t);return e?n.snapshot:qt(n.type.getSnapshot(n,!1))}function I(t,e){void 0===e&&(e=1);for(var n=Dt(t).parent;n;){if(0===--e)return!0;n=n.parent}return!1}function O(t,e){void 0===e&&(e=1);for(var n=e,r=Dt(t).parent;r;){if(0===--n)return r.storedValue;r=r.parent}return Wt("Failed to find the parent of "+Dt(t)+" at depth "+e)}function T(t,e){for(var n=Dt(t).parent;n;){if(e.is(n.storedValue))return!0;n=n.parent}return!1}function V(t,e){for(var n=Dt(t).parent;n;){if(e.is(n.storedValue))return n.storedValue;n=n.parent}return Wt("Failed to find the parent of "+Dt(t)+" of a given type")}function C(t){return Dt(t).root.storedValue}function j(t){return Dt(t).path}function N(t){return he(Dt(t).path)}function _(t){return Dt(t).isRoot}function E(t,e){var n=zt(Dt(t),e);return n?n.value:void 0}function D(t,e,n){var r=Dt(e).root.identifierCache.resolve(t,wn(n));return r?r.value:void 0}function R(t){return Dt(t).identifier}function x(t,e){void 0===e&&(e=!0);try{var n=t();return void 0===n||null===n?void 0:Et(n)?e?U(n)?n:void 0:n:Wt("The reference to be checked is not one of node, null or undefined")}catch(r){if(r instanceof cn)return;throw r}}function k(t,e){void 0===e&&(e=!0);try{var n=t();return void 0!==n&&null!==n&&(Et(n)?!e||U(n):Wt("The reference to be checked is not one of node, null or undefined"))}catch(r){if(r instanceof cn)return!1;throw r}}function z(t,e){var n=zt(Dt(t),e,!1);if(void 0!==n)try{return n.value}catch(r){return}}function M(t,e){return kt(Dt(t),Dt(e))}function F(t,e){void 0===e&&(e=!0);var n=Dt(t);return n.type.create(n.snapshot,!0===e?n.root.environment:!1===e?void 0:e)}function L(t){return Dt(t).detach(),t}function H(t){var e=Dt(t);e.isRoot?e.die():e.parent.removeChild(e.subpath)}function U(t){return Dt(t).observableIsAlive}function $(t,e){return Dt(t).addDisposer(e),e}function W(t){var e=Dt(t).root.environment;return e||Ut}function J(t,e){var n=Dt(t);n.getChildren().forEach((function(t){Et(t.storedValue)&&J(t.storedValue,e)})),e(n.storedValue)}function Y(t){var e;return{name:(e=Et(t)?h(t):t).name,properties:f({},e.properties)}}function Z(t){var e=Dt(t).type,n=f({},Y(e),{actions:[],volatile:[],views:[]});return Object.getOwnPropertyNames(t).forEach((function(e){if(!(e in n.properties)){var r=Object.getOwnPropertyDescriptor(t,e);r.get?Object(i.isComputedProp)(t,e)?n.views.push(e):n.volatile.push(e):!0===r.value._isMSTAction?n.actions.push(e):Object(i.isObservableProp)(t,e)?n.volatile.push(e):n.views.push(e)}})),n}function G(t){return t}function B(t){return t}function K(t){return t}var X,q=function(){function t(t,e,n,r){this._state=Ct.INITIALIZING,this.hookSubscribers=new ee,this.environment=void 0,this.environment=r,this.type=t,this.baseSetParent(e,n)}return Object.defineProperty(t.prototype,"subpath",{get:function(){return this._subpath},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},set:function(t){var e=this.isAlive;this._state=t;var n=this.isAlive;this.aliveAtom&&e!==n&&this.aliveAtom.reportChanged()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),t.prototype.baseSetParent=function(t,e){this._parent=t,this._subpath=e,this._escapedSubpath=void 0,this.pathAtom&&this.pathAtom.reportChanged()},Object.defineProperty(t.prototype,"path",{get:function(){return this.pathAtom||(this.pathAtom=Object(i.createAtom)("path")),this.pathAtom.reportObserved(),this.parent?(void 0===this._escapedSubpath&&(this._escapedSubpath=this._subpath?pe(this._subpath):""),this.parent.path+"/"+this._escapedSubpath):""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isRoot",{get:function(){return null===this.parent},enumerable:!0,configurable:!0}),t.prototype.fireInternalHook=function(t){this.hookSubscribers.emit(t,this,t)},Object.defineProperty(t.prototype,"isAlive",{get:function(){return this.state!==Ct.DEAD},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"observableIsAlive",{get:function(){return this.aliveAtom||(this.aliveAtom=Object(i.createAtom)("alive")),this.aliveAtom.reportObserved(),this.isAlive},enumerable:!0,configurable:!0}),t.prototype.baseFinalizeCreation=function(t){if(this.state===Ct.CREATED){if(this.parent){if(this.parent.state!==Ct.FINALIZED)return;this.fireHook(r.afterAttach)}this.state=Ct.FINALIZED,t&&t()}},t.prototype.baseFinalizeDeath=function(){this.hookSubscribers.clearAll(),this.baseSetParent(null,""),this.state=Ct.DEAD},t.prototype.baseAboutToDie=function(){this.fireHook(r.beforeDestroy)},t}(),Q=function(t){function e(e,n,r,i,o){var a=t.call(this,e,n,r,i)||this;try{a.storedValue=e.createNewInstance(a,{},o)}catch(s){throw a.state=Ct.DEAD,s}return a.state=Ct.CREATED,a.finalizeCreation(),a}return p(e,t),Object.defineProperty(e.prototype,"root",{get:function(){return this.parent?this.parent.root:Wt("This scalar node is not part of a tree")},enumerable:!0,configurable:!0}),e.prototype.setParent=function(t,e){if(void 0===e&&(e=null),this.parent!==t||this.subpath!==e)if(this.parent&&!t)this.die();else{var n=null===e?"":e;t&&t!==this.parent?Wt("assertion failed: scalar nodes cannot change their parent"):this.subpath!==n&&this.baseSetParent(this.parent,n)}},Object.defineProperty(e.prototype,"value",{get:function(){return this.type.getValue(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"snapshot",{get:function(){return qt(this.getSnapshot())},enumerable:!0,configurable:!0}),e.prototype.getSnapshot=function(){return this.type.getSnapshot(this)},e.prototype.toString=function(){return this.type.name+"@"+(this.path||"<root>")+(this.isAlive?"":"[dead]")},e.prototype.die=function(){this.state!==Ct.DETACHING&&(this.aboutToDie(),this.finalizeDeath())},e.prototype.finalizeCreation=function(){this.baseFinalizeCreation()},e.prototype.aboutToDie=function(){this.baseAboutToDie()},e.prototype.finalizeDeath=function(){this.baseFinalizeDeath()},e.prototype.fireHook=function(t){this.fireInternalHook(t)},l([i.action],e.prototype,"die",null),e}(q),tt=1,et={onError:function(t){throw t}},nt=function(t){function e(e,n,r,i,o){var a=t.call(this,e,n,r,i)||this;if(a.nodeId=++tt,a.isProtectionEnabled=!0,a.middlewares=null,a._autoUnbox=!0,a._isRunningAction=!1,a._hasSnapshotReaction=!1,a._internalEvents=new ee,a._observableInstanceState=0,a._cachedInitialSnapshot=null,a.unbox=function(t){return t&&a.assertAlive(),t&&a._autoUnbox?t.value:t},a._initialSnapshot=qt(o),a.identifierAttribute=e.identifierAttribute,n||(a.identifierCache=new Nt),a._childNodes=e.initializeChildNodes(a,a._initialSnapshot),a.identifier=null,a.unnormalizedIdentifier=null,a.identifierAttribute&&a._initialSnapshot){var s=a._initialSnapshot[a.identifierAttribute];if(void 0===s){var u=a._childNodes[a.identifierAttribute];u&&(s=u.value)}"string"!==typeof s&&"number"!==typeof s&&Wt("Instance identifier '"+a.identifierAttribute+"' for type '"+a.type.name+"' must be a string or a number"),a.identifier=wn(s),a.unnormalizedIdentifier=s}return n?n.root.identifierCache.addNodeToCache(a):a.identifierCache.addNodeToCache(a),a}return p(e,t),e.prototype.applyPatches=function(t){this.createObservableInstanceIfNeeded(),this._applyPatches(t)},e.prototype.applySnapshot=function(t){this.createObservableInstanceIfNeeded(),this._applySnapshot(t)},e.prototype.createObservableInstanceIfNeeded=function(){if(0===this._observableInstanceState){this._observableInstanceState=1;for(var t=[],e=this.parent;e&&0===e._observableInstanceState;)t.unshift(e),e=e.parent;for(var n=0,o=t;n<o.length;n++){o[n].createObservableInstanceIfNeeded()}var a,s,u=this.type;try{this.storedValue=u.createNewInstance(this,this._childNodes,this._initialSnapshot),this.preboot(),this._isRunningAction=!0,u.finalizeNewInstance(this,this.storedValue)}catch(c){throw this.state=Ct.DEAD,c}finally{this._isRunningAction=!1}this._observableInstanceState=2,a=this,s="snapshot",Object(i.getAtom)(a,s).trackAndCompute(),this.isRoot&&this._addSnapshotReaction(),this._childNodes=Ut,this.state=Ct.CREATED,this.fireHook(r.afterCreate),this.finalizeCreation()}},Object.defineProperty(e.prototype,"root",{get:function(){var t=this.parent;return t?t.root:this},enumerable:!0,configurable:!0}),e.prototype.setParent=function(t,e){if(void 0===e&&(e=null),this.parent!==t||this.subpath!==e)if(this.parent&&!t)this.die();else{var n=null===e?"":e;t&&t!==this.parent?(t.root.identifierCache.mergeCache(this),this.baseSetParent(t,n),this.fireHook(r.afterAttach)):this.subpath!==n&&this.baseSetParent(this.parent,n)}},e.prototype.fireHook=function(t){var e=this;this.fireInternalHook(t);var n=this.storedValue&&"object"===typeof this.storedValue&&this.storedValue[t];"function"===typeof n&&(i._allowStateChangesInsideComputed?Object(i._allowStateChangesInsideComputed)((function(){n.apply(e.storedValue)})):n.apply(this.storedValue))},Object.defineProperty(e.prototype,"value",{get:function(){if(this.createObservableInstanceIfNeeded(),this.isAlive)return this.type.getValue(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"snapshot",{get:function(){return qt(this.getSnapshot())},enumerable:!0,configurable:!0}),e.prototype.getSnapshot=function(){return this.isAlive?2===this._observableInstanceState?this._getActualSnapshot():this._getInitialSnapshot():this._snapshotUponDeath},e.prototype._getActualSnapshot=function(){return this.type.getSnapshot(this)},e.prototype._getInitialSnapshot=function(){if(!this._initialSnapshot)return this._initialSnapshot;if(this._cachedInitialSnapshot)return this._cachedInitialSnapshot;var t=this.type,e=this._childNodes,n=this._initialSnapshot;return this._cachedInitialSnapshot=t.processInitialSnapshot(e,n),this._cachedInitialSnapshot},e.prototype.isRunningAction=function(){return!!this._isRunningAction||!this.isRoot&&this.parent.isRunningAction()},e.prototype.assertAlive=function(){if(!this.isAlive){var t="You are trying to read or write to an object that is no longer part of a state tree. (Object type was '"+this.type.name+"'). Either detach nodes first, or don't use objects after removing / replacing them in the tree.";switch(s()){case"error":return Wt(t);case"warn":oe(t)}}},e.prototype.getChildNode=function(t){this.assertAlive(),this._autoUnbox=!1;try{return 2===this._observableInstanceState?this.type.getChildNode(this,t):this._childNodes[t]}finally{this._autoUnbox=!0}},e.prototype.getChildren=function(){this.assertAlive(),this._autoUnbox=!1;try{return 2===this._observableInstanceState?this.type.getChildren(this):Ft(this._childNodes)}finally{this._autoUnbox=!0}},e.prototype.getChildType=function(t){return this.type.getChildType(t)},Object.defineProperty(e.prototype,"isProtected",{get:function(){return this.root.isProtectionEnabled},enumerable:!0,configurable:!0}),e.prototype.assertWritable=function(){this.assertAlive(),!this.isRunningAction()&&this.isProtected&&Wt("Cannot modify '"+this+"', the object is protected and can only be modified by using an action.")},e.prototype.removeChild=function(t){this.type.removeChild(this,t)},e.prototype.toString=function(){var t=this.identifier?"(id: "+this.identifier+")":"";return this.type.name+"@"+(this.path||"<root>")+t+(this.isAlive?"":"[dead]")},e.prototype.finalizeCreation=function(){var t=this;this.baseFinalizeCreation((function(){for(var e=0,n=t.getChildren();e<n.length;e++){n[e].finalizeCreation()}t.fireInternalHook(r.afterCreationFinalization)}))},e.prototype.detach=function(){this.isAlive||Wt("Error while detaching, node is not alive."),this.isRoot||(this.fireHook(r.beforeDetach),this.state=Ct.DETACHING,this.environment=this.root.environment,this.identifierCache=this.root.identifierCache.splitCache(this),this.parent.removeChild(this.subpath),this.baseSetParent(null,""),this.state=Ct.FINALIZED)},e.prototype.preboot=function(){var t=this;this._applyPatches=bt(this.storedValue,"@APPLY_PATCHES",(function(e){e.forEach((function(e){var n=he(e.path);Mt(t,n.slice(0,-1)).applyPatchLocally(n[n.length-1],e)}))})),this._applySnapshot=bt(this.storedValue,"@APPLY_SNAPSHOT",(function(e){if(e!==t.snapshot)return t.type.applySnapshot(t,e)})),Qt(this.storedValue,"$treenode",this),Qt(this.storedValue,"toJSON",Rt)},e.prototype.die=function(){this.state!==Ct.DETACHING&&(2===this._observableInstanceState?(this.aboutToDie(),this.finalizeDeath()):this.unregisterIdentifiers())},e.prototype.aboutToDie=function(){this.getChildren().forEach((function(t){t.aboutToDie()})),this.baseAboutToDie(),this._internalEvents.emit("dispose"),this._internalEvents.clear("dispose")},e.prototype.unregisterIdentifiers=function(){var t=this;Object.keys(this._childNodes).forEach((function(n){var r=t._childNodes[n];r instanceof e&&r.unregisterIdentifiers()})),this.root.identifierCache.notifyDied(this)},e.prototype.finalizeDeath=function(){this.getChildren().forEach((function(t){t.finalizeDeath()})),this.root.identifierCache.notifyDied(this);var t=this.snapshot;this._snapshotUponDeath=t,this._internalEvents.clearAll(),this.baseFinalizeDeath()},e.prototype.onSnapshot=function(t){return this._addSnapshotReaction(),this._internalEvents.register("snapshot",t)},e.prototype.emitSnapshot=function(t){this._internalEvents.emit("snapshot",t)},e.prototype.onPatch=function(t){return this._internalEvents.register("patch",t)},e.prototype.emitPatch=function(t,e){var n=this._internalEvents;if(n.hasSubscribers("patch")){var r=function(t){"oldValue"in t||Wt("Patches without `oldValue` field cannot be inversed");return[ue(t),ce(t)]}(function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0;r<e.length;r++){var i=e[r];for(var o in i)t[o]=i[o]}return t}({},t,{path:e.path.substr(this.path.length)+"/"+t.path})),i=r[0],o=r[1];n.emit("patch",i,o)}this.parent&&this.parent.emitPatch(t,e)},e.prototype.hasDisposer=function(t){return this._internalEvents.has("dispose",t)},e.prototype.addDisposer=function(t){this.hasDisposer(t)?Wt("cannot add a disposer when it is already registered for execution"):this._internalEvents.register("dispose",t,!0)},e.prototype.removeDisposer=function(t){if(!this._internalEvents.has("dispose",t))return Wt("cannot remove a disposer which was never registered for execution");this._internalEvents.unregister("dispose",t)},e.prototype.removeMiddleware=function(t){this.middlewares&&(this.middlewares=this.middlewares.filter((function(e){return e.handler!==t})))},e.prototype.addMiddleWare=function(t,e){var n=this;return void 0===e&&(e=!0),this.middlewares?this.middlewares.push({handler:t,includeHooks:e}):this.middlewares=[{handler:t,includeHooks:e}],function(){n.removeMiddleware(t)}},e.prototype.applyPatchLocally=function(t,e){this.assertWritable(),this.createObservableInstanceIfNeeded(),this.type.applyPatchLocally(this,t,e)},e.prototype._addSnapshotReaction=function(){var t=this;if(!this._hasSnapshotReaction){var e=Object(i.reaction)((function(){return t.snapshot}),(function(e){return t.emitSnapshot(e)}),et);this.addDisposer(e),this._hasSnapshotReaction=!0}},l([i.action],e.prototype,"createObservableInstanceIfNeeded",null),l([i.computed],e.prototype,"snapshot",null),l([i.action],e.prototype,"detach",null),l([i.action],e.prototype,"die",null),e}(q);!function(t){t[t.String=1]="String",t[t.Number=2]="Number",t[t.Boolean=4]="Boolean",t[t.Date=8]="Date",t[t.Literal=16]="Literal",t[t.Array=32]="Array",t[t.Map=64]="Map",t[t.Object=128]="Object",t[t.Frozen=256]="Frozen",t[t.Optional=512]="Optional",t[t.Reference=1024]="Reference",t[t.Identifier=2048]="Identifier",t[t.Late=4096]="Late",t[t.Refinement=8192]="Refinement",t[t.Union=16384]="Union",t[t.Null=32768]="Null",t[t.Undefined=65536]="Undefined",t[t.Integer=131072]="Integer"}(X||(X={}));var rt=function(){function t(t){this.isType=!0,this.name=t}return t.prototype.create=function(t,e){return void 0===t&&(t=this.getDefaultSnapshot()),Tt(this,t),this.instantiate(null,"",e,t).value},t.prototype.initializeChildNodes=function(t,e){return Ut},t.prototype.createNewInstance=function(t,e,n){return n},t.prototype.finalizeNewInstance=function(t,e){},t.prototype.processInitialSnapshot=function(t,e){return e},t.prototype.isAssignableFrom=function(t){return t===this},t.prototype.validate=function(t,e){return Et(t)?h(t)===this||this.isAssignableFrom(h(t))?Pt():It(e,t):this.isValidSnapshot(t,e)},t.prototype.is=function(t){return 0===this.validate(t,[{path:"",type:this}]).length},t.prototype.reconcile=function(t,e){if(t.snapshot===e)return t;if(Et(e)&&Dt(e)===t)return t;if(t.type===this&&Kt(e)&&!Et(e)&&(!t.identifierAttribute||t.identifier===wn(e[t.identifierAttribute])))return t.applySnapshot(e),t;var n=t.parent,r=t.subpath;if(t.die(),Et(e)&&this.isAssignableFrom(h(e))){var i=Dt(e);return i.setParent(n,r),i}return this.instantiate(n,r,t.environment,e)},Object.defineProperty(t.prototype,"Type",{get:function(){return Wt("Factory.Type should not be actually called. It is just a Type signature that can be used at compile time with Typescript, by using `typeof type.Type`")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SnapshotType",{get:function(){return Wt("Factory.SnapshotType should not be actually called. It is just a Type signature that can be used at compile time with Typescript, by using `typeof type.SnapshotType`")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CreationType",{get:function(){return Wt("Factory.CreationType should not be actually called. It is just a Type signature that can be used at compile time with Typescript, by using `typeof type.CreationType`")},enumerable:!0,configurable:!0}),l([i.action],t.prototype,"create",null),t}(),it=function(t){function e(e){return t.call(this,e)||this}return p(e,t),e.prototype.getValue=function(t){return t.storedValue},e.prototype.getSnapshot=function(t){return t.storedValue},e.prototype.getDefaultSnapshot=function(){},e.prototype.applySnapshot=function(t,e){Wt("Immutable types do not support applying snapshots")},e.prototype.applyPatchLocally=function(t,e,n){Wt("Immutable types do not support applying patches")},e.prototype.getChildren=function(t){return Ht},e.prototype.getChildNode=function(t,e){return Wt("No child '"+e+"' available in type: "+this.name)},e.prototype.getChildType=function(t){return Wt("No child '"+t+"' available in type: "+this.name)},e.prototype.reconcile=function(t,e){if(t.type===this&&t.storedValue===e)return t;var n=this.instantiate(t.parent,t.subpath,t.environment,e);return t.die(),n},e.prototype.removeChild=function(t,e){return Wt("No child '"+e+"' available in type: "+this.name)},e}(rt);function ot(t){return"object"===typeof t&&t&&!0===t.isType}var at=new Map;function st(t){return function(e,n,r){switch(e.type){case"action":if(t.filter&&!0!==t.filter(e))return n(e);var i=t.onStart(e);t.onResume(e,i),at.set(e.id,{call:e,context:i,async:!1});try{var o=n(e);return t.onSuspend(e,i),!1===at.get(e.id).async&&(at.delete(e.id),t.onSuccess(e,i,o)),o}catch(s){throw at.delete(e.id),t.onFail(e,i,s),s}case"flow_spawn":return(a=at.get(e.rootId)).async=!0,n(e);case"flow_resume":case"flow_resume_error":var a=at.get(e.rootId);t.onResume(e,a.context);try{return n(e)}finally{t.onSuspend(e,a.context)}case"flow_throw":a=at.get(e.rootId);return at.delete(e.rootId),t.onFail(e,a.context,e.args[0]),n(e);case"flow_return":a=at.get(e.rootId);return at.delete(e.rootId),t.onSuccess(e,a.context,e.args[0]),n(e)}}}function ut(t){return{$MST_UNSERIALIZABLE:!0,type:t}}function ct(t,e){Object(i.runInAction)((function(){Gt(e).forEach((function(e){return function(t,e){var n=z(t,e.path||"");if(!n)return Wt("Invalid action path: "+(e.path||""));var r=Dt(n);if("@APPLY_PATCHES"===e.name)return b.call(null,n,e.args[0]);if("@APPLY_SNAPSHOT"===e.name)return A.call(null,n,e.args[0]);"function"!==typeof n[e.name]&&Wt("Action '"+e.name+"' does not exist in '"+r.path+"'");return n[e.name].apply(n,e.args?e.args.map((function(t){return(e=t)&&"object"===typeof e&&"$MST_DATE"in e?new Date(e.$MST_DATE):e;var e})):[])}(t,e)}))}))}function pt(t){var e={actions:[],stop:function(){return n()},replay:function(t){ct(t,e.actions)}},n=ft(t,e.actions.push.bind(e.actions));return e}function ft(t,e,n){return void 0===n&&(n=!1),gt(t,(function(r,i){if("action"===r.type&&r.id===r.rootId){var o=Dt(r.context),a={name:r.name,path:kt(Dt(t),o),args:r.args.map((function(t,e){return function(t,e,n,r){if(r instanceof Date)return{$MST_DATE:r.getTime()};if(Xt(r))return r;if(Et(r))return ut("[MSTNode: "+h(r).name+"]");if("function"===typeof r)return ut("[function]");if("object"===typeof r&&!Bt(r)&&!Zt(r))return ut("[object "+(r&&r.constructor&&r.constructor.name||"Complex Object")+"]");try{return JSON.stringify(r),r}catch(i){return ut(""+i)}}(0,r.name,0,t)}))};if(n){var s=i(r);return e(a),s}return e(a),i(r)}return i(r)}))}var lt=1,ht=null;function dt(){return lt++}function yt(t,e){var n=Dt(t.context),o=n._isRunningAction,a=ht;"action"===t.type&&n.assertAlive(),n._isRunningAction=!0,ht=t;try{return function(t,e,n){var o=function(t,e,n){var r=n.$mst_middleware||Ht,i=t;for(;i;)i.middlewares&&(r=r.concat(i.middlewares)),i=i.parent;return r}(t,0,n);if(!o.length)return Object(i.action)(n).apply(null,e.args);var a=0,s=null;function u(t){var e=o[a++],c=e&&e.handler;function p(t,e){!0,s=e?e(u(t)||s):u(t)}function f(t){!0,s=t}var l=function(){return c(t,p,f),s};return c&&e.includeHooks?l():c&&!e.includeHooks?r[t.name]?u(t):l():Object(i.action)(n).apply(null,t.args)}return u(e)}(n,t,e)}finally{ht=a,n._isRunningAction=o}}function vt(){return ht||Wt("Not running an action!")}function bt(t,e,n){var r=function(){var r=dt();return yt({type:"action",name:e,id:r,args:ne(arguments),context:t,tree:C(t),rootId:ht?ht.rootId:r,parentId:ht?ht.id:0,allParentIds:ht?ht.allParentIds.concat([ht.id]):[]},n)};return r._isMSTAction=!0,r}function gt(t,e,n){return void 0===n&&(n=!0),Dt(t).addMiddleWare(e,n)}function mt(t,e){var n={handler:t,includeHooks:!0};return e.$mst_middleware&&e.$mst_middleware.push(n),e.$mst_middleware=[n],e}function wt(t){return"function"===typeof t?"<function"+(t.name?" "+t.name:"")+">":Et(t)?"<"+t+">":"`"+function(t){try{return JSON.stringify(t)}catch(e){return"<Unserializable: "+e+">"}}(t)+"`"}function St(t){var e=t.value,n=t.context[t.context.length-1].type,r=t.context.map((function(t){return t.path})).filter((function(t){return t.length>0})).join("/"),i=r.length>0?'at path "/'+r+'" ':"",o=Et(e)?"value of type "+Dt(e).type.name+":":Xt(e)?"value":"snapshot",a=n&&Et(e)&&n.is(Dt(e).snapshot);return""+i+o+" "+wt(e)+" is not assignable "+(n?"to type: `"+n.name+"`":"")+(t.message?" ("+t.message+")":"")+(n?He(n)||Xt(e)?".":", expected an instance of `"+n.name+"` or a snapshot like `"+n.describe()+"` instead."+(a?" (Note that a snapshot of the provided value is compatible with the targeted type)":""):".")}function At(t,e,n){return t.concat([{path:e,type:n}])}function Pt(){return Ht}function It(t,e,n){return[{context:t,value:e,message:n}]}function Ot(t){return t.reduce((function(t,e){return t.concat(e)}),[])}function Tt(t,e){}function Vt(t,e){var n,r=t.validate(e,[{path:"",type:t}]);r.length>0&&Wt("Error while converting "+(((n=wt(e)).length<280?n:n.substring(0,272)+"......"+n.substring(n.length-8))+" to `")+t.name+"`:\n\n    "+r.map(St).join("\n    "))}var Ct,jt=0,Nt=function(){function t(){this.cacheId=jt++,this.cache=i.observable.map(),this.lastCacheModificationPerId=i.observable.map()}return t.prototype.updateLastCacheModificationPerId=function(t){var e=this.lastCacheModificationPerId.get(t);this.lastCacheModificationPerId.set(t,void 0===e?1:e+1)},t.prototype.getLastCacheModificationPerId=function(t){var e=this.lastCacheModificationPerId.get(t)||0;return this.cacheId+"-"+e},t.prototype.addNodeToCache=function(t,e){if(void 0===e&&(e=!0),t.identifierAttribute){var n=t.identifier;this.cache.has(n)||this.cache.set(n,i.observable.array([],$t));var r=this.cache.get(n);-1!==r.indexOf(t)&&Wt("Already registered"),r.push(t),e&&this.updateLastCacheModificationPerId(n)}},t.prototype.mergeCache=function(t){var e=this;Object(i.values)(t.identifierCache.cache).forEach((function(t){return t.forEach((function(t){e.addNodeToCache(t)}))}))},t.prototype.notifyDied=function(t){if(t.identifierAttribute){var e=t.identifier,n=this.cache.get(e);n&&(n.remove(t),n.length||this.cache.delete(e),this.updateLastCacheModificationPerId(t.identifier))}},t.prototype.splitCache=function(e){var n=this,r=new t,o=e.path;return Object(i.entries)(this.cache).forEach((function(t){for(var e=t[0],i=t[1],a=!1,s=i.length-1;s>=0;s--)0===i[s].path.indexOf(o)&&(r.addNodeToCache(i[s],!1),i.splice(s,1),a=!0);a&&n.updateLastCacheModificationPerId(e)})),r},t.prototype.has=function(t,e){var n=this.cache.get(e);return!!n&&n.some((function(e){return t.isAssignableFrom(e.type)}))},t.prototype.resolve=function(t,e){var n=this.cache.get(e);if(!n)return null;var r=n.filter((function(e){return t.isAssignableFrom(e.type)}));switch(r.length){case 0:return null;case 1:return r[0];default:return Wt("Cannot resolve a reference to type '"+t.name+"' with id: '"+e+"' unambigously, there are multiple candidates: "+r.map((function(t){return t.path})).join(", "))}},t}();function _t(t,e,n,r,i){var o,a=(o=i)&&o.$treenode||null;if(a){if(a.isRoot)return a.setParent(e,n),a;Wt("Cannot add an object to a state tree if it is already part of the same or another state tree. Tried to assign an object to '"+(e?e.path:"")+"/"+n+"', but it lives already at '"+a.path+"'")}return new(t.shouldAttachNode?nt:Q)(t,e,n,r,i)}function Et(t){return!(!t||!t.$treenode)}function Dt(t){return Et(t)?t.$treenode:Wt("Value "+t+" is no MST Node")}function Rt(){return Dt(this).snapshot}!function(t){t[t.INITIALIZING=0]="INITIALIZING",t[t.CREATED=1]="CREATED",t[t.FINALIZED=2]="FINALIZED",t[t.DETACHING=3]="DETACHING",t[t.DEAD=4]="DEAD"}(Ct||(Ct={}));var xt=function(t){return".."};function kt(t,e){if(t.root!==e.root)return Wt("Cannot calculate relative path: objects '"+t+"' and '"+e+"' are not part of the same object tree");for(var n=he(t.path),r=he(e.path),i=0;i<n.length&&n[i]===r[i];i++);return n.slice(i).map(xt).join("/")+le(r.slice(i))}function zt(t,e,n){return void 0===n&&(n=!0),Mt(t,he(e),n)}function Mt(t,e,n){void 0===n&&(n=!0);for(var r=t,i=0;i<e.length;i++){var o=e[i];if(".."===o){if(r=r.parent)continue}else{if("."===o)continue;if(r){if(r instanceof Q)try{var a=r.value;Et(a)&&(r=Dt(a))}catch(s){if(!n)return;throw s}if(r instanceof nt)if(r.getChildType(o)&&(r=r.getChildNode(o)))continue}}return n?Wt("Could not resolve '"+o+"' in path '"+(le(e.slice(0,i))||"/")+"' while resolving '"+le(e)+"'"):void 0}return r}function Ft(t){if(!t)return Ht;var e=Object.keys(t);if(!e.length)return Ht;var n=new Array(e.length);return e.forEach((function(e,r){n[r]=t[e]})),n}function Lt(t){return ie("process","`process()` has been renamed to `flow()`. See https://github.com/mobxjs/mobx-state-tree/issues/399 for more information. Note that the middleware event types starting with `process` now start with `flow`."),ae(t)}var Ht=Object.freeze([]),Ut=Object.freeze({}),$t="string"===typeof i.$mobx?{deep:!1}:{deep:!1,proxy:!1};function Wt(t){throw void 0===t&&(t="Illegal state"),new Error("[mobx-state-tree] "+t)}function Jt(t){return t}Object.freeze($t);var Yt=Number.isInteger||function(t){return"number"===typeof t&&isFinite(t)&&Math.floor(t)===t};function Zt(t){return!(!Array.isArray(t)&&!Object(i.isObservableArray)(t))}function Gt(t){return t?Zt(t)?t:[t]:Ht}function Bt(t){if(null===t||"object"!==typeof t)return!1;var e=Object.getPrototypeOf(t);return e===Object.prototype||null===e}function Kt(t){return null!==t&&"object"===typeof t&&!(t instanceof Date)&&!(t instanceof RegExp)}function Xt(t){return null===t||void 0===t||("string"===typeof t||"number"===typeof t||"boolean"===typeof t||t instanceof Date)}function qt(t){return t}function Qt(t,e,n){Object.defineProperty(t,e,{enumerable:!1,writable:!1,configurable:!0,value:n})}var te=function(){function t(){this.handlers=[]}return Object.defineProperty(t.prototype,"hasSubscribers",{get:function(){return this.handlers.length>0},enumerable:!0,configurable:!0}),t.prototype.register=function(t,e){var n=this;return void 0===e&&(e=!1),e?this.handlers.unshift(t):this.handlers.push(t),function(){n.unregister(t)}},t.prototype.has=function(t){return this.handlers.indexOf(t)>=0},t.prototype.unregister=function(t){var e=this.handlers.indexOf(t);e>=0&&this.handlers.splice(e,1)},t.prototype.clear=function(){this.handlers.length=0},t.prototype.emit=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this.handlers.slice();n.forEach((function(e){return e.apply(void 0,t)}))},t}(),ee=function(){function t(){}return t.prototype.hasSubscribers=function(t){var e=this.eventHandlers&&this.eventHandlers[t];return!!e&&e.hasSubscribers},t.prototype.register=function(t,e,n){void 0===n&&(n=!1),this.eventHandlers||(this.eventHandlers={});var r=this.eventHandlers[t];return r||(r=this.eventHandlers[t]=new te),r.register(e,n)},t.prototype.has=function(t,e){var n=this.eventHandlers&&this.eventHandlers[t];return!!n&&n.has(e)},t.prototype.unregister=function(t,e){var n=this.eventHandlers&&this.eventHandlers[t];n&&n.unregister(e)},t.prototype.clear=function(t){this.eventHandlers&&delete this.eventHandlers[t]},t.prototype.clearAll=function(){this.eventHandlers=void 0},t.prototype.emit=function(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=this.eventHandlers&&this.eventHandlers[t];i&&(e=i).emit.apply(e,n)},t}();function ne(t){for(var e=new Array(t.length),n=0;n<t.length;n++)e[n]=t[n];return e}function re(t,e){return 0===t.indexOf(e)}var ie=function(t,e){};function oe(t){console.warn(new Error("[mobx-state-tree] "+t))}function ae(t){return function(t,e){var n=function(){var r=dt(),i=vt(),o=arguments;function a(e,o,a){e.$mst_middleware=n.$mst_middleware,yt({name:t,type:o,id:r,args:[a],tree:i.tree,context:i.context,parentId:i.id,allParentIds:i.allParentIds.concat([i.id]),rootId:i.rootId},e)}return new Promise((function(s,u){var c,p=function(){c=e.apply(null,arguments),f(void 0)};function f(t){var e;try{a((function(t){e=c.next(t)}),"flow_resume",t)}catch(n){return void setImmediate((function(){a((function(t){u(n)}),"flow_throw",n)}))}h(e)}function l(t){var e;try{a((function(t){e=c.throw(t)}),"flow_resume_error",t)}catch(n){return void setImmediate((function(){a((function(t){u(n)}),"flow_throw",n)}))}h(e)}function h(t){if(!t.done)return t.value&&"function"===typeof t.value.then||Wt("Only promises can be yielded to `async`, got: "+t),t.value.then(f,l);setImmediate((function(){a((function(t){s(t)}),"flow_return",t.value)}))}p.$mst_middleware=n.$mst_middleware,yt({name:t,type:"flow_spawn",id:r,args:ne(o),tree:i.tree,context:i.context,parentId:i.id,allParentIds:i.allParentIds.concat([i.id]),rootId:i.rootId},p)}))};return n}(t.name,t)}function se(t){return t}function ue(t){switch(t.op){case"add":return{op:"add",path:t.path,value:t.value};case"remove":return{op:"remove",path:t.path};case"replace":return{op:"replace",path:t.path,value:t.value}}}function ce(t){switch(t.op){case"add":return{op:"remove",path:t.path};case"remove":return{op:"add",path:t.path,value:t.oldValue};case"replace":return{op:"replace",path:t.path,value:t.oldValue}}}function pe(t){return!0===("number"===typeof t)?""+t:-1===t.indexOf("/")&&-1===t.indexOf("~")?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}function fe(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}function le(t){if(0===t.length)return"";var e=function(t){return t.map(pe).join("/")};return"."===t[0]||".."===t[0]?e(t):"/"+e(t)}function he(t){var e=t.split("/").map(fe);return""===t||"."===t||".."===t||re(t,"/")||re(t,"./")||re(t,"../")?(""===e[0]&&e.shift(),e):Wt("a json path must be either rooted, empty or relative, but got '"+t+"'")}ie.ids={};var de,ye="Map.put can only be used to store complex values that have an identifier type attribute";function ve(t,e){if(t instanceof Ne)e.push(t);else if(t instanceof Ke){if(!ve(t.type,e))return!1}else if(t instanceof Ze)for(var n=0;n<t.types.length;n++){if(!ve(t.types[n],e))return!1}else if(t instanceof nn){var r=t.getSubType(!1);if(!r)return!1;ve(r,e)}return!0}!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.YES=1]="YES",t[t.NO=2]="NO"}(de||(de={}));var be=function(t){function e(e){return t.call(this,e,i.observable.ref.enhancer)||this}return p(e,t),e.prototype.get=function(e){return t.prototype.get.call(this,""+e)},e.prototype.has=function(e){return t.prototype.has.call(this,""+e)},e.prototype.delete=function(e){return t.prototype.delete.call(this,""+e)},e.prototype.set=function(e,n){return t.prototype.set.call(this,""+e,n)},e.prototype.put=function(t){if(t||Wt("Map.put cannot be used to set empty values"),Et(t)){var e=Dt(t);0;var n=e.identifier;return this.set(n,e.value),e.value}if(Kt(t)){n=void 0;var r=Dt(this).type;return r.identifierMode===de.NO?Wt(ye):r.identifierMode===de.YES?(n=wn(t[r.mapIdentifierAttribute]),this.set(n,t),this.get(n)):Wt(ye)}return Wt("Map.put can only be used to store complex values")},e}(i.ObservableMap),ge=function(t){function e(e,n){var r=t.call(this,e)||this;return r.shouldAttachNode=!0,r.identifierMode=de.UNKNOWN,r.mapIdentifierAttribute=void 0,r.flags=X.Map,r.subType=n,r._determineIdentifierMode(),r}return p(e,t),e.prototype.instantiate=function(t,e,n,r){return this.identifierMode===de.UNKNOWN&&this._determineIdentifierMode(),_t(this,t,e,n,r)},e.prototype._determineIdentifierMode=function(){var t=[];if(ve(this.subType,t)){var e=void 0;t.forEach((function(t){t.identifierAttribute&&(e&&e!==t.identifierAttribute&&Wt("The objects in a map should all have the same identifier attribute, expected '"+e+"', but child of type '"+t.name+"' declared attribute '"+t.identifierAttribute+"' as identifier"),e=t.identifierAttribute)})),e?(this.identifierMode=de.YES,this.mapIdentifierAttribute=e):this.identifierMode=de.NO}},e.prototype.initializeChildNodes=function(t,e){void 0===e&&(e={});var n=t.type.subType,r=t.environment,i={};return Object.keys(e).forEach((function(o){i[o]=n.instantiate(t,o,r,e[o])})),i},e.prototype.createNewInstance=function(t,e,n){return new be(e)},e.prototype.finalizeNewInstance=function(t,e){Object(i._interceptReads)(e,t.unbox),Object(i.intercept)(e,this.willChange),Object(i.observe)(e,this.didChange)},e.prototype.describe=function(){return"Map<string, "+this.subType.describe()+">"},e.prototype.getChildren=function(t){return Object(i.values)(t.storedValue)},e.prototype.getChildNode=function(t,e){var n=t.storedValue.get(""+e);return n||Wt("Not a child "+e),n},e.prototype.willChange=function(t){var e=Dt(t.object),n=t.name;e.assertWritable();var r=e.type,i=r.subType;switch(t.type){case"update":var o=t.newValue;if(o===t.object.get(n))return null;t.newValue=i.reconcile(e.getChildNode(n),t.newValue),r.processIdentifier(n,t.newValue);break;case"add":t.newValue,t.newValue=i.instantiate(e,n,void 0,t.newValue),r.processIdentifier(n,t.newValue)}return t},e.prototype.processIdentifier=function(t,e){if(this.identifierMode===de.YES&&e instanceof nt){var n=e.identifier;n!==t&&Wt("A map of objects containing an identifier should always store the object under their own identifier. Trying to store key '"+n+"', but expected: '"+t+"'")}},e.prototype.getValue=function(t){return t.storedValue},e.prototype.getSnapshot=function(t){var e={};return t.getChildren().forEach((function(t){e[t.subpath]=t.snapshot})),e},e.prototype.processInitialSnapshot=function(t,e){var n={};return Object.keys(t).forEach((function(e){n[e]=t[e].getSnapshot()})),n},e.prototype.didChange=function(t){var e=Dt(t.object);switch(t.type){case"update":return void e.emitPatch({op:"replace",path:pe(t.name),value:t.newValue.snapshot,oldValue:t.oldValue?t.oldValue.snapshot:void 0},e);case"add":return void e.emitPatch({op:"add",path:pe(t.name),value:t.newValue.snapshot,oldValue:void 0},e);case"delete":var n=t.oldValue.snapshot;return t.oldValue.die(),void e.emitPatch({op:"remove",path:pe(t.name),oldValue:n},e)}},e.prototype.applyPatchLocally=function(t,e,n){var r=t.storedValue;switch(n.op){case"add":case"replace":r.set(e,n.value);break;case"remove":r.delete(e)}},e.prototype.applySnapshot=function(t,e){var n=t.storedValue,r={};for(var i in Array.from(n.keys()).forEach((function(t){r[t]=!1})),e)n.set(i,e[i]),r[""+i]=!0;Object.keys(r).forEach((function(t){!1===r[t]&&n.delete(t)}))},e.prototype.getChildType=function(t){return this.subType},e.prototype.isValidSnapshot=function(t,e){var n=this;return Bt(t)?Ot(Object.keys(t).map((function(r){return n.subType.validate(t[r],At(e,r,n.subType))}))):It(e,t,"Value is not a plain object")},e.prototype.getDefaultSnapshot=function(){return Ut},e.prototype.removeChild=function(t,e){t.storedValue.delete(e)},l([i.action],e.prototype,"applySnapshot",null),e}(rt);function me(t){return ot(t)&&(t.flags&X.Map)>0}var we=function(t){function e(e,n){var r=t.call(this,e)||this;return r.shouldAttachNode=!0,r.flags=X.Array,r.subType=n,r}return p(e,t),e.prototype.instantiate=function(t,e,n,r){return _t(this,t,e,n,r)},e.prototype.initializeChildNodes=function(t,e){void 0===e&&(e=[]);var n=t.type.subType,r=t.environment,i={};return e.forEach((function(e,o){var a=""+o;i[a]=n.instantiate(t,a,r,e)})),i},e.prototype.createNewInstance=function(t,e,n){return i.observable.array(Ft(e),$t)},e.prototype.finalizeNewInstance=function(t,e){Object(i._getAdministration)(e).dehancer=t.unbox,Object(i.intercept)(e,this.willChange),Object(i.observe)(e,this.didChange)},e.prototype.describe=function(){return this.subType.describe()+"[]"},e.prototype.getChildren=function(t){return t.storedValue.slice()},e.prototype.getChildNode=function(t,e){var n=parseInt(e,10);return n<t.storedValue.length?t.storedValue[n]:Wt("Not a child: "+e)},e.prototype.willChange=function(t){var e=Dt(t.object);e.assertWritable();var n=e.type.subType,r=e.getChildren(),i=null;switch(t.type){case"update":if(t.newValue===t.object[t.index])return null;if(!(i=Se(e,n,[r[t.index]],[t.newValue],[t.index])))return null;t.newValue=i[0];break;case"splice":var o=t.index,a=t.removedCount,s=t.added;if(!(i=Se(e,n,r.slice(o,o+a),s,s.map((function(t,e){return o+e})))))return null;t.added=i;for(var u=o+a;u<r.length;u++)r[u].setParent(e,""+(u+s.length-a))}return t},e.prototype.getValue=function(t){return t.storedValue},e.prototype.getSnapshot=function(t){return t.getChildren().map((function(t){return t.snapshot}))},e.prototype.processInitialSnapshot=function(t,e){var n=[];return Object.keys(t).forEach((function(e){n.push(t[e].getSnapshot())})),n},e.prototype.didChange=function(t){var e=Dt(t.object);switch(t.type){case"update":return void e.emitPatch({op:"replace",path:""+t.index,value:t.newValue.snapshot,oldValue:t.oldValue?t.oldValue.snapshot:void 0},e);case"splice":for(var n=t.removedCount-1;n>=0;n--)e.emitPatch({op:"remove",path:""+(t.index+n),oldValue:t.removed[n].snapshot},e);for(n=0;n<t.addedCount;n++)e.emitPatch({op:"add",path:""+(t.index+n),value:e.getChildNode(""+(t.index+n)).snapshot,oldValue:void 0},e);return}},e.prototype.applyPatchLocally=function(t,e,n){var r=t.storedValue,i="-"===e?r.length:parseInt(e);switch(n.op){case"replace":r[i]=n.value;break;case"add":r.splice(i,0,n.value);break;case"remove":r.splice(i,1)}},e.prototype.applySnapshot=function(t,e){t.storedValue.replace(e)},e.prototype.getChildType=function(t){return this.subType},e.prototype.isValidSnapshot=function(t,e){var n=this;return Zt(t)?Ot(t.map((function(t,r){return n.subType.validate(t,At(e,""+r,n.subType))}))):It(e,t,"Value is not an array")},e.prototype.getDefaultSnapshot=function(){return Ht},e.prototype.removeChild=function(t,e){t.storedValue.splice(parseInt(e,10),1)},l([i.action],e.prototype,"applySnapshot",null),e}(rt);function Se(t,e,n,r,i){for(var o,a,s,u=!1,c=void 0,p=!0,f=0;u=f<=r.length-1,o=n[f],a=u?r[f]:void 0,((s=a)instanceof Q||s instanceof nt)&&(a=a.storedValue),o||u;f++)if(u)if(o)if(Pe(o,a))n[f]=Ae(e,t,""+i[f],a,o);else{c=void 0;for(var l=f;l<n.length;l++)if(Pe(n[l],a)){c=n.splice(l,1)[0];break}n.splice(f,0,Ae(e,t,""+i[f],a,c)),p=!1}else Et(a)&&Dt(a).parent===t&&Wt("Cannot add an object to a state tree if it is already part of the same or another state tree. Tried to assign an object to '"+t.path+"/"+i[f]+"', but it lives already at '"+Dt(a).path+"'"),n.splice(f,0,Ae(e,t,""+i[f],a)),p=!1;else o.die(),n.splice(f,1),f--,p=!1;return p?null:n}function Ae(t,e,n,r,i){var o;if(Et(r)&&((o=Dt(r)).assertAlive(),null!==o.parent&&o.parent===e))return o.setParent(e,n),i&&i!==o&&i.die(),o;return i?((o=t.reconcile(i,r)).setParent(e,n),o):t.instantiate(e,n,e.environment,r)}function Pe(t,e){return Et(e)?Dt(e)===t:t.snapshot===e||!!(t instanceof nt&&null!==t.identifier&&t.identifierAttribute&&Bt(e)&&t.identifier===wn(e[t.identifierAttribute])&&t.type.is(e))}function Ie(t){return ot(t)&&(t.flags&X.Array)>0}var Oe="preProcessSnapshot",Te="postProcessSnapshot";function Ve(){return Dt(this).toString()}var Ce={name:"AnonymousModel",properties:{},initializers:Ht};function je(t){return Object.keys(t).reduce((function(t,e){var n,i,o;if(e in r)return Wt("Hook '"+e+"' was defined as property. Hooks should be defined as part of the actions");var a=Object.getOwnPropertyDescriptor(t,e);"get"in a&&Wt("Getters are not supported as properties. Please use views instead");var s=a.value;if(null===s||void 0===s)Wt("The default value of an attribute cannot be null or undefined as the type cannot be inferred. Did you mean `types.maybe(someType)`?");else{if(Xt(s))return Object.assign({},t,((n={})[e]=Xe(function(t){switch(typeof t){case"string":return Re;case"number":return xe;case"boolean":return ze;case"object":if(t instanceof Date)return Le}return Wt("Cannot determine primitive type from value "+t)}(s),s),n));if(s instanceof ge)return Object.assign({},t,((i={})[e]=Xe(s,{}),i));if(s instanceof we)return Object.assign({},t,((o={})[e]=Xe(s,[]),o));if(ot(s))return t;Wt("Invalid type definition for property '"+e+"', cannot infer a type from a value like '"+s+"' ("+typeof s+")")}}),t)}var Ne=function(t){function e(e){var n=t.call(this,e.name||Ce.name)||this;n.flags=X.Object,n.shouldAttachNode=!0;var r=e.name||Ce.name;return/^\w[\w\d_]*$/.test(r)||Wt("Typename should be a valid identifier: "+r),Object.assign(n,Ce,e),n.properties=je(n.properties),n.properties,n.propertyNames=Object.keys(n.properties),n.identifierAttribute=n._getIdentifierAttribute(),n}return p(e,t),e.prototype._getIdentifierAttribute=function(){var t=void 0;return this.forAllProps((function(e,n){n.flags&X.Identifier&&(t&&Wt("Cannot define property '"+e+"' as object identifier, property '"+t+"' is already defined as identifier property"),t=e)})),t},e.prototype.cloneAndEnhance=function(t){return new e({name:t.name||this.name,properties:Object.assign({},this.properties,t.properties),initializers:this.initializers.concat(t.initializers||[]),preProcessor:t.preProcessor||this.preProcessor,postProcessor:t.postProcessor||this.postProcessor})},e.prototype.actions=function(t){var e=this;return this.cloneAndEnhance({initializers:[function(n){return e.instantiateActions(n,t(n)),n}]})},e.prototype.instantiateActions=function(t,e){Bt(e)||Wt("actions initializer should return a plain object containing actions"),Object.keys(e).forEach((function(n){n===Oe&&Wt("Cannot define action 'preProcessSnapshot', it should be defined using 'type.preProcessSnapshot(fn)' instead"),n===Te&&Wt("Cannot define action 'postProcessSnapshot', it should be defined using 'type.postProcessSnapshot(fn)' instead");var i=e[n],o=t[n];if(n in r&&o){var a=i;i=function(){o.apply(null,arguments),a.apply(null,arguments)}}var s=i.$mst_middleware,u=i.bind(e);u.$mst_middleware=s;var c=bt(t,n,u);e[n]=c,Qt(t,n,c)}))},e.prototype.named=function(t){return this.cloneAndEnhance({name:t})},e.prototype.props=function(t){return this.cloneAndEnhance({properties:t})},e.prototype.volatile=function(t){var e=this;return this.cloneAndEnhance({initializers:[function(n){return e.instantiateVolatileState(n,t(n)),n}]})},e.prototype.instantiateVolatileState=function(t,e){Bt(e)||Wt("volatile state initializer should return a plain object containing state"),Object(i.set)(t,e)},e.prototype.extend=function(t){var e=this;return this.cloneAndEnhance({initializers:[function(n){var r=t(n),i=r.actions,o=r.views,a=r.state,s=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&(n[r[i]]=t[r[i]])}return n}(r,["actions","views","state"]);for(var u in s)Wt("The `extend` function should return an object with a subset of the fields 'actions', 'views' and 'state'. Found invalid key '"+u+"'");return a&&e.instantiateVolatileState(n,a),o&&e.instantiateViews(n,o),i&&e.instantiateActions(n,i),n}]})},e.prototype.views=function(t){var e=this;return this.cloneAndEnhance({initializers:[function(n){return e.instantiateViews(n,t(n)),n}]})},e.prototype.instantiateViews=function(t,e){Bt(e)||Wt("views initializer should return a plain object containing views"),Object.keys(e).forEach((function(n){var r=Object.getOwnPropertyDescriptor(e,n),o=r.value;if("get"in r)if(Object(i.isComputedProp)(t,n)){var a=Object(i._getAdministration)(t,n);a.derivation=r.get,a.scope=t,r.set&&(a.setter=Object(i.action)(a.name+"-setter",r.set))}else Object(i.computed)(t,n,r,!0);else"function"===typeof o?Qt(t,n,o):Wt("A view member should either be a function or getter based property")}))},e.prototype.preProcessSnapshot=function(t){var e=this.preProcessor;return e?this.cloneAndEnhance({preProcessor:function(n){return e(t(n))}}):this.cloneAndEnhance({preProcessor:t})},e.prototype.postProcessSnapshot=function(t){var e=this.postProcessor;return e?this.cloneAndEnhance({postProcessor:function(n){return t(e(n))}}):this.cloneAndEnhance({postProcessor:t})},e.prototype.instantiate=function(t,e,n,r){return _t(this,t,e,n,Et(r)?r:this.applySnapshotPreProcessor(r))},e.prototype.initializeChildNodes=function(t,e){void 0===e&&(e={});var n=t.type,r={};return n.forAllProps((function(n,i){r[n]=i.instantiate(t,n,t.environment,e[n])})),r},e.prototype.createNewInstance=function(t,e,n){return i.observable.object(e,Ut,$t)},e.prototype.finalizeNewInstance=function(t,e){Qt(e,"toString",Ve),this.forAllProps((function(n){Object(i._interceptReads)(e,n,t.unbox)})),this.initializers.reduce((function(t,e){return e(t)}),e),Object(i.intercept)(e,this.willChange),Object(i.observe)(e,this.didChange)},e.prototype.willChange=function(t){var e=Dt(t.object);e.assertWritable();var n=e.type.properties[t.name];return n&&(t.newValue,t.newValue=n.reconcile(e.getChildNode(t.name),t.newValue)),t},e.prototype.didChange=function(t){var e=Dt(t.object);if(e.type.properties[t.name]){var n=t.oldValue?t.oldValue.snapshot:void 0;e.emitPatch({op:"replace",path:pe(t.name),value:t.newValue.snapshot,oldValue:n},e)}},e.prototype.getChildren=function(t){var e=this,n=[];return this.forAllProps((function(r,i){n.push(e.getChildNode(t,r))})),n},e.prototype.getChildNode=function(t,e){if(!(e in this.properties))return Wt("Not a value property: "+e);var n=Object(i._getAdministration)(t.storedValue,e).value;return n||Wt("Node not available for property "+e)},e.prototype.getValue=function(t){return t.storedValue},e.prototype.getSnapshot=function(t,e){var n=this;void 0===e&&(e=!0);var r={};return this.forAllProps((function(e,o){Object(i.getAtom)(t.storedValue,e).reportObserved(),r[e]=n.getChildNode(t,e).snapshot})),e?this.applySnapshotPostProcessor(r):r},e.prototype.processInitialSnapshot=function(t,e){var n={};return Object.keys(t).forEach((function(e){n[e]=t[e].getSnapshot()})),this.applySnapshotPostProcessor(this.applyOptionalValuesToSnapshot(n))},e.prototype.applyPatchLocally=function(t,e,n){"replace"!==n.op&&"add"!==n.op&&Wt("object does not support operation "+n.op),t.storedValue[e]=n.value},e.prototype.applySnapshot=function(t,e){var n=this.applySnapshotPreProcessor(e);this.forAllProps((function(e,r){t.storedValue[e]=n[e]}))},e.prototype.applySnapshotPreProcessor=function(t){var e=this.preProcessor;return e?e.call(null,t):t},e.prototype.applyOptionalValuesToSnapshot=function(t){return t&&(t=Object.assign({},t),this.forAllProps((function(e,n){if(!(e in t)){var r=Ee(n);r&&(t[e]=r.getDefaultValueSnapshot())}}))),t},e.prototype.applySnapshotPostProcessor=function(t){var e=this.postProcessor;return e?e.call(null,t):t},e.prototype.getChildType=function(t){return this.properties[t]},e.prototype.isValidSnapshot=function(t,e){var n=this,r=this.applySnapshotPreProcessor(t);return Bt(r)?Ot(this.propertyNames.map((function(t){return n.properties[t].validate(r[t],At(e,t,n.properties[t]))}))):It(e,r,"Value is not a plain object")},e.prototype.forAllProps=function(t){var e=this;this.propertyNames.forEach((function(n){return t(n,e.properties[n])}))},e.prototype.describe=function(){var t=this;return"{ "+this.propertyNames.map((function(e){return e+": "+t.properties[e].describe()})).join("; ")+" }"},e.prototype.getDefaultSnapshot=function(){return Ut},e.prototype.removeChild=function(t,e){t.storedValue[e]=void 0},l([i.action],e.prototype,"applySnapshot",null),e}(rt);function _e(t){return ot(t)&&(t.flags&X.Object)>0}function Ee(t){if(t)return t.flags&X.Union&&t.types?t.types.find(Ee):t.flags&X.Late&&t.getSubType&&t.getSubType(!1)?Ee(t.subType):t.flags&X.Optional?t:void 0}var De=function(t){function e(e,n,r,i){void 0===i&&(i=Jt);var o=t.call(this,e)||this;return o.shouldAttachNode=!1,o.flags=n,o.checker=r,o.initializer=i,o}return p(e,t),e.prototype.describe=function(){return this.name},e.prototype.instantiate=function(t,e,n,r){return _t(this,t,e,n,r)},e.prototype.createNewInstance=function(t,e,n){return this.initializer(n)},e.prototype.isValidSnapshot=function(t,e){return Xt(t)&&this.checker(t)?Pt():It(e,t,"Value is not a "+("Date"===this.name?"Date or a unix milliseconds timestamp":this.name))},e}(it),Re=new De("string",X.String,(function(t){return"string"===typeof t})),xe=new De("number",X.Number,(function(t){return"number"===typeof t})),ke=new De("integer",X.Integer,(function(t){return Yt(t)})),ze=new De("boolean",X.Boolean,(function(t){return"boolean"===typeof t})),Me=new De("null",X.Null,(function(t){return null===t})),Fe=new De("undefined",X.Undefined,(function(t){return void 0===t})),Le=new De("Date",X.Date,(function(t){return"number"===typeof t||t instanceof Date}),(function(t){return t instanceof Date?t:new Date(t)}));function He(t){return ot(t)&&(t.flags&(X.String|X.Number|X.Integer|X.Boolean|X.Date))>0}Le.getSnapshot=function(t){return t.storedValue.getTime()};var Ue=function(t){function e(e){var n=t.call(this,JSON.stringify(e))||this;return n.shouldAttachNode=!1,n.flags=X.Literal,n.value=e,n}return p(e,t),e.prototype.instantiate=function(t,e,n,r){return _t(this,t,e,n,r)},e.prototype.describe=function(){return JSON.stringify(this.value)},e.prototype.isValidSnapshot=function(t,e){return Xt(t)&&t===this.value?Pt():It(e,t,"Value is not a literal "+JSON.stringify(this.value))},e}(it);function $e(t){return new Ue(t)}function We(t){return ot(t)&&(t.flags&X.Literal)>0}var Je=function(t){function e(e,n,r,i){var o=t.call(this,e)||this;return o.type=n,o.predicate=r,o.message=i,o}return p(e,t),Object.defineProperty(e.prototype,"flags",{get:function(){return this.type.flags|X.Refinement},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shouldAttachNode",{get:function(){return this.type.shouldAttachNode},enumerable:!0,configurable:!0}),e.prototype.describe=function(){return this.name},e.prototype.instantiate=function(t,e,n,r){return this.type.instantiate(t,e,n,r)},e.prototype.isAssignableFrom=function(t){return this.type.isAssignableFrom(t)},e.prototype.isValidSnapshot=function(t,e){var n=this.type.validate(t,e);if(n.length>0)return n;var r=Et(t)?Dt(t).snapshot:t;return this.predicate(r)?Pt():It(e,t,this.message(t))},e}(it);function Ye(t){return(t.flags&X.Refinement)>0}var Ze=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.eager=!0,r=f({eager:!0,dispatcher:void 0},r),i.dispatcher=r.dispatcher,r.eager||(i.eager=!1),i.types=n,i}return p(e,t),Object.defineProperty(e.prototype,"flags",{get:function(){var t=X.Union;return this.types.forEach((function(e){t|=e.flags})),t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shouldAttachNode",{get:function(){return this.types.some((function(t){return t.shouldAttachNode}))},enumerable:!0,configurable:!0}),e.prototype.isAssignableFrom=function(t){return this.types.some((function(e){return e.isAssignableFrom(t)}))},e.prototype.describe=function(){return"("+this.types.map((function(t){return t.describe()})).join(" | ")+")"},e.prototype.instantiate=function(t,e,n,r){var i=this.determineType(r,void 0);return i?i.instantiate(t,e,n,r):Wt("No matching type for union "+this.describe())},e.prototype.reconcile=function(t,e){var n=this.determineType(e,t.type);return n?n.reconcile(t,e):Wt("No matching type for union "+this.describe())},e.prototype.determineType=function(t,e){return this.dispatcher?this.dispatcher(t):e?e.is(t)?e:this.types.filter((function(t){return t!==e})).find((function(e){return e.is(t)})):this.types.find((function(e){return e.is(t)}))},e.prototype.isValidSnapshot=function(t,e){if(this.dispatcher)return this.dispatcher(t).validate(t,e);for(var n=[],r=0,i=0;i<this.types.length;i++){var o=this.types[i].validate(t,e);if(0===o.length){if(this.eager)return Pt();r++}else n.push(o)}return 1===r?Pt():It(e,t,"No type is applicable for the union").concat(Ot(n))},e}(it);function Ge(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=ot(t)?void 0:t,i=ot(t)?[t].concat(e):e,o="("+i.map((function(t){return t.name})).join(" | ")+")";return new Ze(o,i,r)}function Be(t){return(t.flags&X.Union)>0}var Ke=function(t){function e(e,n){var r=t.call(this,e.name)||this;return r.type=e,r.defaultValue=n,r}return p(e,t),Object.defineProperty(e.prototype,"flags",{get:function(){return this.type.flags|X.Optional},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shouldAttachNode",{get:function(){return this.type.shouldAttachNode},enumerable:!0,configurable:!0}),e.prototype.describe=function(){return this.type.describe()+"?"},e.prototype.instantiate=function(t,e,n,r){if("undefined"===typeof r){var i=this.getDefaultInstanceOrSnapshot();return this.type.instantiate(t,e,n,i)}return this.type.instantiate(t,e,n,r)},e.prototype.reconcile=function(t,e){return this.type.reconcile(t,this.type.is(e)&&void 0!==e?e:this.getDefaultInstanceOrSnapshot())},e.prototype.getDefaultInstanceOrSnapshot=function(){var t="function"===typeof this.defaultValue?this.defaultValue():this.defaultValue;return this.defaultValue,t},e.prototype.getDefaultValueSnapshot=function(){var t=this.getDefaultInstanceOrSnapshot();return Et(t)?Dt(t).snapshot:t},e.prototype.isValidSnapshot=function(t,e){return void 0===t?Pt():this.type.validate(t,e)},e.prototype.isAssignableFrom=function(t){return this.type.isAssignableFrom(t)},e}(it);function Xe(t,e){return"function"!==typeof e&&Et(e)&&Wt("default value cannot be an instance, pass a snapshot or a function that creates an instance/snapshot instead"),new Ke(t,e)}function qe(t){return ot(t)&&(t.flags&X.Optional)>0}var Qe=Xe(Fe,void 0),tn=Xe(Me,null);function en(t){return Ge(t,Qe)}var nn=function(t){function e(e,n){var r=t.call(this,e)||this;return r._subType=null,r.definition=n,r}return p(e,t),Object.defineProperty(e.prototype,"flags",{get:function(){return(this._subType?this._subType.flags:0)|X.Late},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shouldAttachNode",{get:function(){return this.getSubType(!0).shouldAttachNode},enumerable:!0,configurable:!0}),e.prototype.getSubType=function(t){if(null===this._subType){var e=void 0;try{e=this.definition()}catch(n){if(!(n instanceof ReferenceError))throw n;e=void 0}if(t&&void 0===e&&Wt("Late type seems to be used too early, the definition (still) returns undefined"),e)return this._subType=e,e}return this._subType},e.prototype.instantiate=function(t,e,n,r){return this.getSubType(!0).instantiate(t,e,n,r)},e.prototype.reconcile=function(t,e){return this.getSubType(!0).reconcile(t,e)},e.prototype.describe=function(){var t=this.getSubType(!1);return t?t.name:"<uknown late type>"},e.prototype.isValidSnapshot=function(t,e){var n=this.getSubType(!1);return n?n.validate(t,e):Pt()},e.prototype.isAssignableFrom=function(t){var e=this.getSubType(!1);return!!e&&e.isAssignableFrom(t)},e}(it);function rn(t){return ot(t)&&(t.flags&X.Late)>0}var on=function(t){function e(e){var n=t.call(this,e?"frozen("+e.name+")":"frozen")||this;return n.subType=e,n.shouldAttachNode=!1,n.flags=X.Frozen,n}return p(e,t),e.prototype.describe=function(){return"<any immutable value>"},e.prototype.instantiate=function(t,e,n,r){return _t(this,t,e,n,r)},e.prototype.isValidSnapshot=function(t,e){return function(t){return"function"!==typeof t}(t)?this.subType?this.subType.validate(t,e):Pt():It(e,t,"Value is not serializable and cannot be frozen")},e}(it),an=new on;function sn(t){return ot(t)&&(t.flags&X.Frozen)>0}var un=function(){function t(t,e){if(this.targetType=e,"string"===typeof t||"number"===typeof t)this.identifier=t;else{if(!Et(t))return Wt("Can only store references to tree nodes or identifiers, got: '"+t+"'");var n=Dt(t);if(!n.identifierAttribute)return Wt("Can only store references with a defined identifier attribute.");var r=n.unnormalizedIdentifier;if(null===r||void 0===r)return Wt("Can only store references to tree nodes with a defined identifier.");this.identifier=r}}return t.prototype.updateResolvedReference=function(t){var e=wn(this.identifier),n=t.root.identifierCache.getLastCacheModificationPerId(e);if(!this.resolvedReference||this.resolvedReference.lastCacheModification!==n){var r=this.targetType,i=t.root.identifierCache.resolve(r,e);if(!i)throw new cn("[mobx-state-tree] Failed to resolve reference '"+this.identifier+"' to type '"+this.targetType.name+"' (from node: "+t.path+")");this.resolvedReference={node:i,lastCacheModification:n}}},Object.defineProperty(t.prototype,"resolvedValue",{get:function(){return this.updateResolvedReference(this.node),this.resolvedReference.node.value},enumerable:!0,configurable:!0}),t}(),cn=function(t){function e(n){var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),r}return p(e,t),e}(Error),pn=function(t){function e(e,n){var r=t.call(this,"reference("+e.name+")")||this;return r.targetType=e,r.onInvalidated=n,r.shouldAttachNode=!1,r.flags=X.Reference,r}return p(e,t),e.prototype.describe=function(){return this.name},e.prototype.isAssignableFrom=function(t){return this.targetType.isAssignableFrom(t)},e.prototype.isValidSnapshot=function(t,e){return"string"===typeof t||"number"===typeof t?Pt():It(e,t,"Value is not a valid identifier, which is a string or a number")},e.prototype.fireInvalidated=function(t,e,n,r){var i=e.parent;if(i&&i.isAlive){var o=i.storedValue;o&&this.onInvalidated({cause:t,parent:o,invalidTarget:r?r.storedValue:void 0,invalidId:n,replaceRef:function(t){b(e.root.storedValue,{op:"replace",value:t,path:e.path})},removeRef:function(){_e(i.type)?this.replaceRef(void 0):b(e.root.storedValue,{op:"remove",path:e.path})}})}},e.prototype.addTargetNodeWatcher=function(t,e){var n=this,i=this.getValue(t);if(i){var o=Dt(i),a=function(i,a){var s=function(t){switch(t){case r.beforeDestroy:return"destroy";case r.beforeDetach:return"detach";default:return}}(a);s&&n.fireInvalidated(s,t,e,o)},s=o.hookSubscribers.register(r.beforeDetach,a),u=o.hookSubscribers.register(r.beforeDestroy,a);return function(){s(),u()}}},e.prototype.watchTargetNodeForInvalidations=function(t,e,n){var i=this;if(this.onInvalidated){var o;t.hookSubscribers.register(r.beforeDestroy,(function(){o&&o()}));var a=function(r){o&&o();var a=t.parent,s=a&&a.storedValue;if(a&&a.isAlive&&s){(n?!!n.get(e,s):t.root.identifierCache.has(i.targetType,wn(e)))?o=i.addTargetNodeWatcher(t,e):r||i.fireInvalidated("invalidSnapshotReference",t,e,null)}};t.state===Ct.FINALIZED?a(!0):(t.isRoot||t.root.hookSubscribers.register(r.afterCreationFinalization,(function(){t.parent&&t.parent.createObservableInstanceIfNeeded()})),t.hookSubscribers.register(r.afterAttach,(function(){a(!1)})))}},e}(it),fn=function(t){function e(e,n){return t.call(this,e,n)||this}return p(e,t),e.prototype.getValue=function(t){if(t.isAlive)return t.storedValue.resolvedValue},e.prototype.getSnapshot=function(t){return t.storedValue.identifier},e.prototype.instantiate=function(t,e,n,r){var i=Et(r)?R(r):r,o=new un(r,this.targetType),a=_t(this,t,e,n,o);return o.node=a,this.watchTargetNodeForInvalidations(a,i,void 0),a},e.prototype.reconcile=function(t,e){if(t.type===this){var n=Et(e),r=t.storedValue;if(!n&&r.identifier===e)return t;if(n&&r.resolvedValue===e)return t}var i=this.instantiate(t.parent,t.subpath,t.environment,e);return t.die(),i},e}(pn),ln=function(t){function e(e,n,r){var i=t.call(this,e,r)||this;return i.options=n,i}return p(e,t),e.prototype.getValue=function(t){if(t.isAlive)return this.options.get(t.storedValue,t.parent?t.parent.storedValue:null)},e.prototype.getSnapshot=function(t){return t.storedValue},e.prototype.instantiate=function(t,e,n,r){var i=Et(r)?this.options.set(r,t?t.storedValue:null):r,o=_t(this,t,e,n,i);return this.watchTargetNodeForInvalidations(o,i,this.options),o},e.prototype.reconcile=function(t,e){var n=Et(e)?this.options.set(e,t?t.storedValue:null):e;if(t.type===this&&t.storedValue===n)return t;var r=this.instantiate(t.parent,t.subpath,t.environment,n);return t.die(),r},e}(pn);function hn(t,e){var n=e||void 0,r=e?e.onInvalidated:void 0;return n&&(n.get||n.set)?new ln(t,{get:n.get,set:n.set},r):new fn(t,r)}function dn(t){return(t.flags&X.Reference)>0}var yn=function(t){function e(){var e=t.call(this,"identifier")||this;return e.shouldAttachNode=!1,e.flags=X.Identifier,e}return p(e,t),e.prototype.instantiate=function(t,e,n,r){return t&&t.type instanceof Ne||Wt("Identifier types can only be instantiated as direct child of a model type"),_t(this,t,e,n,r)},e.prototype.reconcile=function(t,e){return t.storedValue!==e?Wt("Tried to change identifier from '"+t.storedValue+"' to '"+e+"'. Changing identifiers is not allowed."):t},e.prototype.describe=function(){return"identifier"},e.prototype.isValidSnapshot=function(t,e){return"string"!==typeof t?It(e,t,"Value is not a valid identifier, expected a string"):Pt()},e}(it),vn=function(t){function e(){var e=t.call(this)||this;return e.name="identifierNumber",e}return p(e,t),e.prototype.instantiate=function(e,n,r,i){return t.prototype.instantiate.call(this,e,n,r,i)},e.prototype.isValidSnapshot=function(t,e){return"number"===typeof t?Pt():It(e,t,"Value is not a valid identifierNumber, expected a number")},e.prototype.reconcile=function(e,n){return t.prototype.reconcile.call(this,e,n)},e.prototype.getSnapshot=function(t){return t.storedValue},e.prototype.describe=function(){return"identifierNumber"},e}(yn),bn=new yn,gn=new vn;function mn(t){return ot(t)&&(t.flags&X.Identifier)>0}function wn(t){return""+t}var Sn=function(t){function e(e){var n=t.call(this,e.name)||this;return n.options=e,n.flags=X.Reference,n.shouldAttachNode=!1,n}return p(e,t),e.prototype.describe=function(){return this.name},e.prototype.isAssignableFrom=function(t){return t===this},e.prototype.isValidSnapshot=function(t,e){if(this.options.isTargetType(t))return Pt();var n=this.options.getValidationMessage(t);return n?It(e,t,"Invalid value for type '"+this.name+"': "+n):Pt()},e.prototype.getValue=function(t){if(t.isAlive)return t.storedValue},e.prototype.getSnapshot=function(t){return this.options.toSnapshot(t.storedValue)},e.prototype.instantiate=function(t,e,n,r){return _t(this,t,e,n,this.options.isTargetType(r)?r:this.options.fromSnapshot(r))},e.prototype.reconcile=function(t,e){var n=!this.options.isTargetType(e);if(t.type===this&&(n?e===t.snapshot:e===t.storedValue))return t;var r=n?this.options.fromSnapshot(e):e,i=this.instantiate(t.parent,t.subpath,t.environment,r);return t.die(),i},e}(it),An={enumeration:function(t,e){var n="string"===typeof t?e:t,r=Ge.apply(void 0,n.map((function(t){return $e(""+t)})));return"string"===typeof t&&(r.name=t),r},model:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="string"===typeof t[0]?t.shift():"AnonymousModel",r=t.shift()||{};return new Ne({name:n,properties:r})},compose:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="string"===typeof t[0]?t.shift():"AnonymousModel";return t.reduce((function(t,e){return t.cloneAndEnhance({name:t.name+"_"+e.name,properties:e.properties,initializers:e.initializers,preProcessor:function(n){return e.applySnapshotPreProcessor(t.applySnapshotPreProcessor(n))},postProcessor:function(n){return e.applySnapshotPostProcessor(t.applySnapshotPostProcessor(n))}})})).named(n)},custom:function(t){return new Sn(t)},reference:hn,safeReference:function(t,e){return en(hn(t,f({},e,{onInvalidated:function(t){t.removeRef()}})))},union:Ge,optional:Xe,literal:$e,maybe:en,maybeNull:function(t){return Ge(t,tn)},refinement:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="string"===typeof t[0]?t.shift():ot(t[0])?t[0].name:null,r=t[0],i=t[1],o=t[2]?t[2]:function(t){return"Value does not respect the refinement predicate"};return new Je(n,r,i,o)},string:Re,boolean:ze,number:xe,integer:ke,Date:Le,map:function(t){return new ge("map<string, "+t.name+">",t)},array:function(t){return new we(t.name+"[]",t)},frozen:function(t){return 0===arguments.length?an:ot(t)?new on(t):Xe(an,t)},identifier:bn,identifierNumber:gn,late:function(t,e){var n="string"===typeof t?t:"late("+t.toString()+")";return new nn(n,"string"===typeof t?e:t)},undefined:Fe,null:Me}}}]);
module.exports=function(t){var e=require("../../../ssr-module-cache.js");function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}},a=!0;try{t[r].call(o.exports,o,o.exports,n),a=!1}finally{a&&delete e[r]}return o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=6)}({"/+oN":function(t,e){t.exports=require("core-js/library/fn/object/get-prototype-of")},"1qCV":function(t,e,n){t.exports=n("qJj/")},"4YdT":function(t,e,n){"use strict";n.r(e);var r=n("UrUy"),o=n.n(r),a=n("Rbzu"),c=n("R3/3"),u=n("JYC+"),i=n.n(u),s=n("LkAs"),f=n("bMj6"),l=n("hZod"),d=n("tEuJ"),p=n("YKN3"),b=n("azxR"),y=n("cDcd"),v=n.n(y),m=n("AVMw"),j=n("z3IF"),h=n("hDBU"),O=n("pL2a"),x=n.n(O),g=n("E/TB");function w(t){var e=t.bodyClasses,n=void 0===e?[]:e,r=t.className,o=void 0===r?"":r,c=t.css,u=void 0===c?"":c,i=t.onLoad,s=void 0===i?g.a:i,f=t.onUnload,l=void 0===f?g.a:f,d=t.queryString,p=void 0===d?{}:d,m=t.src,O=void 0===m?"":m,w=t.title,q=void 0===w?"IFrame":w,E=t.windowRef,T=void 0===E?g.a:E,U=Object(y.useRef)(),L=Object(y.useEffect)(function(){var t=U.current.contentDocument,e=U.current.contentWindow;return s({document:t,window:e}),T(e),function(){return l({document:t,window:e})}},[]);Object(y.useEffect)(function(){var t=U.current.contentDocument.body;if(!t)return g.a;var e=n.filter(Boolean);return e.forEach(function(e){return t.classList.add(e)}),function(){return e.forEach(function(e){return t.classList.remove(e)})}},[n]),Object(y.useEffect)(function(){var t=U.current.contentDocument.head;if(t){var e=t.querySelector("style#injected");e||((e=U.current.contentDocument.createElement("style")).id="injected",t.appendChild(e)),e.innerHTML=u}},[u]);var S=Object(y.useMemo)(function(){var t=x()(p).filter(function(t){return void 0!==Object(h.a)(t,2)[1]}).reduce(function(t,e){var n=Object(h.a)(e,2),r=n[0],o=n[1];return Object(a.a)({},t,Object(b.a)({},r,o))},{}),e=new URLSearchParams(t).toString();return O.match(/[?]/)?"".concat(O,"&").concat(e):"".concat(O,"?").concat(e)},[O,p]);return v.a.createElement("iframe",Object(j.a)({onLoad:L,ref:U,src:S},{className:o,title:q}))}var q=n("lTgw"),E=n("8qGm"),T=n("VTEe"),U=n("TTmL");n("KqK1");n.d(e,"default",function(){return S});var L=["mousedown","mouseup","keydown","keyup"],S=function(t){function e(){var t,n;Object(s.a)(this,e);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return n=Object(f.a)(this,(t=Object(l.a)(e)).call.apply(t,[this].concat(o))),Object(b.a)(Object(p.a)(Object(p.a)(n)),"state",{data:n.props.data}),Object(b.a)(Object(p.a)(Object(p.a)(n)),"handleUserInteraction",Object(E.a)(function(){n.iframeWindow&&n.iframeWindow.packageJsonData&&n.setState({data:n.iframeWindow.packageJsonData()})},1e3)),Object(b.a)(Object(p.a)(Object(p.a)(n)),"handleGenerate",function(){var t=n.context.router,e=n.props.slug;t.push("/map?slug=".concat(e,"&generate=true"),"/map/".concat(e,"?generate=true"))}),Object(b.a)(Object(p.a)(Object(p.a)(n)),"handleIWindowRef",function(t){n.iframeWindow=t}),Object(b.a)(Object(p.a)(Object(p.a)(n)),"handleOnLoad",function(t){var e=t.document,r=t.window;n.props.data&&(r.displayJsonData(n.props.data),r.hideLoadingMessage());var o=e.querySelector("svg#map");L.forEach(function(t){r.addEventListener(t,n.handleUserInteraction),o&&o.addEventListener(t,n.handleUserInteraction)})}),Object(b.a)(Object(p.a)(Object(p.a)(n)),"handleOnUnload",function(t){var e=t.document,r=t.window,o=e.querySelector("svg#map");L.forEach(function(t){r.removeEventListener(t,n.handleUserInteraction),o&&o.removeEventListener(t,n.handleUserInteraction)})}),Object(b.a)(Object(p.a)(Object(p.a)(n)),"handleSave",function(){localStorage.setItem("mapJson",i()(n.state.data))}),Object(b.a)(Object(p.a)(Object(p.a)(n)),"render",function(){var t,e=n.context.router.query.generate,r=n.props,o=r.data,a=r.isEditable;return t=o||a&&e?v.a.createElement(w,{bodyClasses:[a?"editable":"readOnly"],className:"map-frame",css:"\n            .readOnly #viewbox, .readOnly #scaleBar {\n              pointer-events: none;\n            }\n            .readOnly #optionsTab, .readOnly #toolsTab, .readOnly #regenerate {\n              display: none!important;\n            }\n          ",onLoad:n.handleOnLoad,onUnload:n.handleOnUnload,src:"/static/fantasy-map-generator",queryString:{doNotGenerate:!!o||void 0},title:"map",windowRef:n.handleIWindowRef}):a?v.a.createElement(m.a,{className:"center"},a&&v.a.createElement(v.a.Fragment,null,"This map doesn't exist. Would you like to ",v.a.createElement("button",{className:"safe",onClick:n.handleGenerate},"Generate It?"))):v.a.createElement(m.a,{className:"center"},"This map either doesn't exist, or you don't have permission to view it."),v.a.createElement("div",{className:"map page"},t)}),n}return Object(d.a)(e,t),e}(y.Component);Object(b.a)(S,"contextType",q.a),Object(b.a)(S,"defaultProps",{data:null,readOnly:!1}),Object(b.a)(S,"getInitialProps",function(){var t=Object(c.a)(o.a.mark(function t(e){var n,r,c,u,i;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.query,r=e.req,c=Object(T.a)(r&&r.headers,"cookie"),t.next=4,fetch(Object(U.a)(r,"/api/map/".concat(n.slug)),{headers:c});case 4:return u=t.sent,t.next=7,u.json();case 7:return i=t.sent,t.abrupt("return",Object(a.a)({httpStatusCode:u.status},i));case 9:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}())},6:function(t,e,n){t.exports=n("4YdT")},"6Ndq":function(t,e,n){t.exports=n("o5io")},"8qGm":function(t,e,n){"use strict";function r(t,e,n){var r,o=this;return function(){for(var a=arguments.length,c=new Array(a),u=0;u<a;u++)c[u]=arguments[u];var i=n&&!r;clearTimeout(r),r=setTimeout(function(){r=null,n||t.apply(o,c)},e),i&&t.apply(o,c)}}n.d(e,"a",function(){return r})},AVMw:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n("cDcd"),o=n.n(r);n("sILV");function a(t){var e=t.className,n=void 0===e?"":e,r=t.children,a=void 0===r?[]:r,c=t.type,u=void 0===c?"info":c;return o.a.createElement("div",{className:"alert ".concat(u," ").concat(n)},a)}},"E/TB":function(t,e,n){"use strict";e.a=function(){}},FkRQ:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n("s20r"),o=n.n(r);function a(t){if(o()(t))return t}},"J3/a":function(t,e){t.exports=require("core-js/library/fn/get-iterator")},"JYC+":function(t,e,n){t.exports=n("fozc")},KqK1:function(t,e){},LkAs:function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return r})},OKNm:function(t,e,n){t.exports=n("Wk4r")},R2Q7:function(t,e){t.exports=require("core-js/library/fn/array/is-array")},"R3/3":function(t,e,n){"use strict";n.d(e,"a",function(){return c});var r=n("ZOIa"),o=n.n(r);function a(t,e,n,r,a,c,u){try{var i=t[c](u),s=i.value}catch(t){return void n(t)}i.done?e(s):o.a.resolve(s).then(r,a)}function c(t){return function(){var e=this,n=arguments;return new o.a(function(r,o){var c=t.apply(e,n);function u(t){a(c,r,o,u,i,"next",t)}function i(t){a(c,r,o,u,i,"throw",t)}u(void 0)})}}},Rbzu:function(t,e,n){"use strict";n.d(e,"a",function(){return f});var r=n("tvLF"),o=n.n(r),a=n("s4hn"),c=n.n(a),u=n("1qCV"),i=n.n(u),s=n("azxR");function f(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=i()(n);"function"==typeof c.a&&(r=r.concat(c()(n).filter(function(t){return o()(n,t).enumerable}))),r.forEach(function(e){Object(s.a)(t,e,n[e])})}return t}},SWa5:function(t,e){t.exports=require("core-js/library/fn/object/entries")},SY1S:function(t,e,n){t.exports=n("J3/a")},TTmL:function(t,e,n){"use strict";e.a=function(t,e){var n=t?"".concat(t.protocol,"://").concat(t.get("Host")):"";return"".concat(n).concat(e)}},TUA0:function(t,e){t.exports=require("core-js/library/fn/object/define-property")},U8Yc:function(t,e,n){t.exports=n("dGr4")},UrUy:function(t,e,n){t.exports=n("cu1A")},VTEe:function(t,e,n){"use strict";var r=n("gDVU"),o=n("JYC+"),a=n.n(o),c=n("s20r"),u=n.n(c);e.a=function(t){if(!t||"object"!==Object(r.a)(t))return{};for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;if(!e||!u()(e))throw new TypeError("cannot flatten non-Array value ".concat(a()(e)));return e.reduce(function(e,r){return n>1&&r&&u()(r)?e.concat(t(r,n-1)):e.concat(r)},[])}(n).reduce(function(e,n){return t.hasOwnProperty(n)&&(e[n]=t[n]),e},{})}},Wk4r:function(t,e){t.exports=require("core-js/library/fn/object/set-prototype-of")},XzKa:function(t,e,n){t.exports=n("vqFK")},YKN3:function(t,e,n){"use strict";function r(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}n.d(e,"a",function(){return r})},Z6Kq:function(t,e){t.exports=require("core-js/library/fn/object/get-own-property-descriptor")},ZOIa:function(t,e,n){t.exports=n("aC71")},aC71:function(t,e){t.exports=require("core-js/library/fn/promise")},azxR:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n("hHgk"),o=n.n(r);function a(t,e,n){return e in t?o()(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},bMj6:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n("gDVU"),o=n("YKN3");function a(t,e){return!e||"object"!==Object(r.a)(e)&&"function"!=typeof e?Object(o.a)(t):e}},cDcd:function(t,e){t.exports=require("react")},cu1A:function(t,e){t.exports=require("regenerator-runtime")},dGr4:function(t,e){t.exports=require("core-js/library/fn/object/assign")},fozc:function(t,e){t.exports=require("core-js/library/fn/json/stringify")},gDVU:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n("t+lh"),o=n.n(r),a=n("XzKa"),c=n.n(a);function u(t){return(u="function"==typeof c.a&&"symbol"==typeof o.a?function(t){return typeof t}:function(t){return t&&"function"==typeof c.a&&t.constructor===c.a&&t!==c.a.prototype?"symbol":typeof t})(t)}function i(t){return(i="function"==typeof c.a&&"symbol"===u(o.a)?function(t){return u(t)}:function(t){return t&&"function"==typeof c.a&&t.constructor===c.a&&t!==c.a.prototype?"symbol":u(t)})(t)}},"gHn/":function(t,e){t.exports=require("core-js/library/fn/symbol/iterator")},hDBU:function(t,e,n){"use strict";var r=n("FkRQ"),o=n("SY1S"),a=n.n(o);var c=n("lFqb");function u(t,e){return Object(r.a)(t)||function(t,e){var n=[],r=!0,o=!1,c=void 0;try{for(var u,i=a()(t);!(r=(u=i.next()).done)&&(n.push(u.value),!e||n.length!==e);r=!0);}catch(t){o=!0,c=t}finally{try{r||null==i.return||i.return()}finally{if(o)throw c}}return n}(t,e)||Object(c.a)()}n.d(e,"a",function(){return u})},hHgk:function(t,e,n){t.exports=n("TUA0")},hZod:function(t,e,n){"use strict";n.d(e,"a",function(){return u});var r=n("jDdP"),o=n.n(r),a=n("OKNm"),c=n.n(a);function u(t){return(u=c.a?o.a:function(t){return t.__proto__||o()(t)})(t)}},jDdP:function(t,e,n){t.exports=n("/+oN")},k1wZ:function(t,e){t.exports=require("core-js/library/fn/object/get-own-property-symbols")},lFqb:function(t,e,n){"use strict";function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}n.d(e,"a",function(){return r})},lTgw:function(t,e,n){"use strict";var r=n("cDcd"),o=n.n(r);e.a=o.a.createContext({campaign:{createdAt:null,createdBy:{},editors:[],lastUpdatedAt:null,lastUpdatedBy:{},navigation:[],owners:[],secret:!1,subdomain:"",theme:{background:"#fff",fontFamily:"Ubuntu",normalText:"#333",primary:"#42afe3",primaryText:"#fff"},title:"New Campaign",version:0},user:{anonymous:!0}})},o5io:function(t,e){t.exports=require("core-js/library/fn/object/create")},pL2a:function(t,e,n){t.exports=n("SWa5")},"qJj/":function(t,e){t.exports=require("core-js/library/fn/object/keys")},s20r:function(t,e,n){t.exports=n("R2Q7")},s4hn:function(t,e,n){t.exports=n("k1wZ")},sILV:function(t,e){},"t+lh":function(t,e,n){t.exports=n("gHn/")},tEuJ:function(t,e,n){"use strict";var r=n("6Ndq"),o=n.n(r),a=n("OKNm"),c=n.n(a);function u(t,e){return(u=c.a||function(t,e){return t.__proto__=e,t})(t,e)}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=o()(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}n.d(e,"a",function(){return i})},tvLF:function(t,e,n){t.exports=n("Z6Kq")},vqFK:function(t,e){t.exports=require("core-js/library/fn/symbol")},z3IF:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n("U8Yc"),o=n.n(r);function a(){return(a=o.a||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}}});